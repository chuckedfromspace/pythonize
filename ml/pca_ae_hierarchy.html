
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PCA Autoencoder (Part 2) &#8212; Pythonize Data Crunching and Visualization</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/tabs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Pythonize Data Crunching and Visualization</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Fluid Dynamics
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../fluids/flow_field_vis.html">
   Flow Field Visualization
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../fluids/pvc_p1.html">
     Precessing Vortex Core (Part 1)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../fluids/pvc_p2.html">
     Precessing Vortex Core (Part 2)
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../fluids/refs_f.html">
   References
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="pattern_recognition.html">
   Pattern Recognition
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="pca_ae.html">
     PCA Autoencoder (Part 1)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pca_ae_rotation.html">
     PCA Autoencoder (Part 2)
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Finance
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../finance/portfolio_management.html">
   Portfolio Management
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../finance/net_worth.html">
     Net Worth
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../finance/performance.html">
     Performance
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/ml/pca_ae_hierarchy.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/chuckedfromspace/pythonize"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/chuckedfromspace/pythonize/issues/new?title=Issue%20on%20page%20%2Fml/pca_ae_hierarchy.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/chuckedfromspace/pythonize/edit/main/pythonize/ml/pca_ae_hierarchy.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#synthesize-dataset">
   Synthesize dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setup">
     Setup
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#phantom-binary-ellipses">
     Phantom binary ellipses
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pca-autoencoder">
   PCA Autoencoder
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#covariance-loss">
     Covariance loss
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#standard-autoencoder-components">
     Standard autoencoder components
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#autonencoder-1">
     Autonencoder 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examine-the-results">
     Examine the results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#autoencoder-2">
   Autoencoder 2
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cnn-autoencoder">
   CNN Autoencoder
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="pca-autoencoder-part-2">
<h1>PCA Autoencoder (Part 2)<a class="headerlink" href="#pca-autoencoder-part-2" title="Permalink to this headline">¶</a></h1>
<div class="section" id="synthesize-dataset">
<h2>Synthesize dataset<a class="headerlink" href="#synthesize-dataset" title="Permalink to this headline">¶</a></h2>
<p>In this notebook, I will just try to recreate the set of binary ellipses with only two variables (two variables) and leave out the rotation for the time being.</p>
<div class="section" id="setup">
<h3>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>


<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="phantom-binary-ellipses">
<h3>Phantom binary ellipses<a class="headerlink" href="#phantom-binary-ellipses" title="Permalink to this headline">¶</a></h3>
<p>I will use the same image dimension (64, 64) as stated in the paper. With a batch size of 500, I chose a sample size of 8000 to get 16 minibatches per epoch (it seems the total sample size was not provided in the paper, unless I missed it).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">phantomEllipse</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">R</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">R</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">img</span><span class="p">[</span><span class="n">img</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">img</span><span class="p">[</span><span class="n">img</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">img</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">num_batch</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_batch</span> <span class="o">*</span> <span class="n">batch_size</span><span class="p">)</span>
<span class="n">random_gen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">random_gen</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">random_gen</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">phantomEllipse</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">_a</span><span class="p">,</span> <span class="n">_b</span><span class="p">)</span> <span class="k">for</span> <span class="n">_a</span><span class="p">,</span> <span class="n">_b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)])</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>  <span class="c1"># pay attention to the shape of the dataset!</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s look at a sample of 8 images from the dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">frames</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="n">frames</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/pca_ae_hierarchy_6_0.png" src="../_images/pca_ae_hierarchy_6_0.png" />
</div>
</div>
<p>As can be seen, the ellipses have essentially two degrees of freedom (horizontal and vertical axes). Ideally, a latent space containing two codes in the autoencoder should suffice to capture these two main features in the dataset. Let’s see what a traditional CNN-autoencoder could do.</p>
</div>
</div>
<div class="section" id="pca-autoencoder">
<h2>PCA Autoencoder<a class="headerlink" href="#pca-autoencoder" title="Permalink to this headline">¶</a></h2>
<p>I will not strictly follow model structure presented in the paper. I will adopt a more conventional “pyramid” architecture with increasing filters in the encoder hidden layers (and vice versa for the decoder). The goal here is not to optimize the autoencoder to minimize the losses. The focus is rather on the functional differences between autoencoder and PCA encoder introduced by the authors.</p>
<div class="section" id="covariance-loss">
<h3>Covariance loss<a class="headerlink" href="#covariance-loss" title="Permalink to this headline">¶</a></h3>
<p>To implement the additional covariance loss term, a custom layer will be created for utilizing the <code class="docutils literal notranslate"><span class="pre">.add_loss()</span></code> method built into the standard <code class="docutils literal notranslate"><span class="pre">keras.layers.Layer</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">LatentCovarianceLayer</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lam</span> <span class="o">=</span> <span class="n">lam</span>
    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">covariance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lam</span> <span class="o">*</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">reduce_prod</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_loss</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">covariance</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">inputs</span>
    <span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">base_config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="n">base_config</span><span class="p">,</span> <span class="s2">&quot;lam&quot;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">lam</span><span class="p">,}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="standard-autoencoder-components">
<h3>Standard autoencoder components<a class="headerlink" href="#standard-autoencoder-components" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">encoder_gen</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>  

    <span class="k">return</span> <span class="n">x</span>

<span class="k">def</span> <span class="nf">decoder_gen</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">16</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2DTranspose</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2DTranspose</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2DTranspose</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2DTranspose</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2DTranspose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="autonencoder-1">
<h3>Autonencoder 1<a class="headerlink" href="#autonencoder-1" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>

<span class="n">input_img</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">encoded</span> <span class="o">=</span> <span class="n">encoder_gen</span><span class="p">(</span><span class="n">input_img</span><span class="p">)</span>
<span class="n">decoded</span> <span class="o">=</span> <span class="n">decoder_gen</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span>
<span class="n">pca_ae</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">input_img</span><span class="p">,</span> <span class="n">decoded</span><span class="p">)</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.002</span><span class="p">)</span>
<span class="n">pca_ae</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>

<span class="n">tempfn</span><span class="o">=</span><span class="s1">&#39;./model_0.hdf5&#39;</span>
<span class="n">model_cb</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ModelCheckpoint</span><span class="p">(</span><span class="n">tempfn</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span><span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">early_cb</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">learning_rate_reduction</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span>
                                                            <span class="n">patience</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
                                                            <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                                            <span class="n">factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                                            <span class="n">min_lr</span><span class="o">=</span><span class="mf">0.00001</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_cb</span><span class="p">,</span> <span class="n">early_cb</span><span class="p">,</span> <span class="n">learning_rate_reduction</span><span class="p">]</span>

<span class="n">history</span><span class="o">=</span><span class="n">pca_ae</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span>
                   <span class="n">epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                   <span class="n">batch_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
                   <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">callbacks</span><span class="o">=</span><span class="n">cb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/1000
16/16 [==============================] - 31s 54ms/step - loss: 0.1976

Epoch 00001: loss improved from inf to 0.19760, saving model to ./model_0.hdf5
Epoch 2/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.1620

Epoch 00002: loss improved from 0.19760 to 0.16198, saving model to ./model_0.hdf5
Epoch 3/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.1193

Epoch 00003: loss improved from 0.16198 to 0.11930, saving model to ./model_0.hdf5
Epoch 4/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0794

Epoch 00004: loss improved from 0.11930 to 0.07945, saving model to ./model_0.hdf5
Epoch 5/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0651

Epoch 00005: loss improved from 0.07945 to 0.06514, saving model to ./model_0.hdf5
Epoch 6/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0600

Epoch 00006: loss improved from 0.06514 to 0.05998, saving model to ./model_0.hdf5
Epoch 7/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0575

Epoch 00007: loss improved from 0.05998 to 0.05749, saving model to ./model_0.hdf5
Epoch 8/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0568

Epoch 00008: loss improved from 0.05749 to 0.05675, saving model to ./model_0.hdf5
Epoch 9/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0566

Epoch 00009: loss improved from 0.05675 to 0.05655, saving model to ./model_0.hdf5
Epoch 10/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0559

Epoch 00010: loss improved from 0.05655 to 0.05586, saving model to ./model_0.hdf5
Epoch 11/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0562

Epoch 00011: loss did not improve from 0.05586
Epoch 12/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0553

Epoch 00012: loss improved from 0.05586 to 0.05525, saving model to ./model_0.hdf5
Epoch 13/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0544

Epoch 00013: loss improved from 0.05525 to 0.05442, saving model to ./model_0.hdf5
Epoch 14/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0545

Epoch 00014: loss did not improve from 0.05442
Epoch 15/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0550

Epoch 00015: loss did not improve from 0.05442
Epoch 16/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0553

Epoch 00016: loss did not improve from 0.05442
Epoch 17/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0542

Epoch 00017: loss improved from 0.05442 to 0.05420, saving model to ./model_0.hdf5
Epoch 18/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0534

Epoch 00018: loss improved from 0.05420 to 0.05344, saving model to ./model_0.hdf5
Epoch 19/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0529

Epoch 00019: loss improved from 0.05344 to 0.05289, saving model to ./model_0.hdf5
Epoch 20/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0525

Epoch 00020: loss improved from 0.05289 to 0.05255, saving model to ./model_0.hdf5
Epoch 21/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0524

Epoch 00021: loss improved from 0.05255 to 0.05240, saving model to ./model_0.hdf5
Epoch 22/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0521

Epoch 00022: loss improved from 0.05240 to 0.05211, saving model to ./model_0.hdf5
Epoch 23/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0517

Epoch 00023: loss improved from 0.05211 to 0.05169, saving model to ./model_0.hdf5
Epoch 24/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0507

Epoch 00024: loss improved from 0.05169 to 0.05074, saving model to ./model_0.hdf5
Epoch 25/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0497

Epoch 00025: loss improved from 0.05074 to 0.04967, saving model to ./model_0.hdf5
Epoch 26/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0493

Epoch 00026: loss improved from 0.04967 to 0.04934, saving model to ./model_0.hdf5
Epoch 27/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0482

Epoch 00027: loss improved from 0.04934 to 0.04824, saving model to ./model_0.hdf5
Epoch 28/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0469

Epoch 00028: loss improved from 0.04824 to 0.04692, saving model to ./model_0.hdf5
Epoch 29/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0468

Epoch 00029: loss improved from 0.04692 to 0.04683, saving model to ./model_0.hdf5
Epoch 30/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0458

Epoch 00030: loss improved from 0.04683 to 0.04575, saving model to ./model_0.hdf5
Epoch 31/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0453

Epoch 00031: loss improved from 0.04575 to 0.04530, saving model to ./model_0.hdf5
Epoch 32/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0449

Epoch 00032: loss improved from 0.04530 to 0.04493, saving model to ./model_0.hdf5
Epoch 33/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0451

Epoch 00033: loss did not improve from 0.04493
Epoch 34/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0447

Epoch 00034: loss improved from 0.04493 to 0.04472, saving model to ./model_0.hdf5
Epoch 35/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0443

Epoch 00035: loss improved from 0.04472 to 0.04429, saving model to ./model_0.hdf5
Epoch 36/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0440

Epoch 00036: loss improved from 0.04429 to 0.04400, saving model to ./model_0.hdf5
Epoch 37/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0442

Epoch 00037: loss did not improve from 0.04400
Epoch 38/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0441

Epoch 00038: loss did not improve from 0.04400
Epoch 39/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0447

Epoch 00039: loss did not improve from 0.04400
Epoch 40/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0441

Epoch 00040: loss did not improve from 0.04400
Epoch 41/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0439

Epoch 00041: loss improved from 0.04400 to 0.04387, saving model to ./model_0.hdf5
Epoch 42/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0432

Epoch 00042: loss improved from 0.04387 to 0.04318, saving model to ./model_0.hdf5
Epoch 43/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0431

Epoch 00043: loss improved from 0.04318 to 0.04314, saving model to ./model_0.hdf5
Epoch 44/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0432

Epoch 00044: loss did not improve from 0.04314
Epoch 45/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0431

Epoch 00045: loss improved from 0.04314 to 0.04307, saving model to ./model_0.hdf5
Epoch 46/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0429

Epoch 00046: loss improved from 0.04307 to 0.04295, saving model to ./model_0.hdf5
Epoch 47/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0434

Epoch 00047: loss did not improve from 0.04295
Epoch 48/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0425

Epoch 00048: loss improved from 0.04295 to 0.04249, saving model to ./model_0.hdf5
Epoch 49/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0426

Epoch 00049: loss did not improve from 0.04249
Epoch 50/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0422

Epoch 00050: loss improved from 0.04249 to 0.04216, saving model to ./model_0.hdf5
Epoch 51/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0421

Epoch 00051: loss improved from 0.04216 to 0.04213, saving model to ./model_0.hdf5
Epoch 52/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0419

Epoch 00052: loss improved from 0.04213 to 0.04186, saving model to ./model_0.hdf5
Epoch 53/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0416

Epoch 00053: loss improved from 0.04186 to 0.04164, saving model to ./model_0.hdf5
Epoch 54/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0416

Epoch 00054: loss improved from 0.04164 to 0.04159, saving model to ./model_0.hdf5
Epoch 55/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0412

Epoch 00055: loss improved from 0.04159 to 0.04121, saving model to ./model_0.hdf5
Epoch 56/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0408

Epoch 00056: loss improved from 0.04121 to 0.04081, saving model to ./model_0.hdf5
Epoch 57/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0405

Epoch 00057: loss improved from 0.04081 to 0.04053, saving model to ./model_0.hdf5
Epoch 58/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0398

Epoch 00058: loss improved from 0.04053 to 0.03979, saving model to ./model_0.hdf5
Epoch 59/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0393

Epoch 00059: loss improved from 0.03979 to 0.03928, saving model to ./model_0.hdf5
Epoch 60/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0390

Epoch 00060: loss improved from 0.03928 to 0.03895, saving model to ./model_0.hdf5
Epoch 61/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0378

Epoch 00061: loss improved from 0.03895 to 0.03783, saving model to ./model_0.hdf5
Epoch 62/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0371

Epoch 00062: loss improved from 0.03783 to 0.03710, saving model to ./model_0.hdf5
Epoch 63/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0365

Epoch 00063: loss improved from 0.03710 to 0.03648, saving model to ./model_0.hdf5
Epoch 64/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0360

Epoch 00064: loss improved from 0.03648 to 0.03598, saving model to ./model_0.hdf5
Epoch 65/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0358

Epoch 00065: loss improved from 0.03598 to 0.03584, saving model to ./model_0.hdf5
Epoch 66/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0358

Epoch 00066: loss did not improve from 0.03584
Epoch 67/1000
16/16 [==============================] - 1s 51ms/step - loss: 0.0359

Epoch 00067: loss did not improve from 0.03584
Epoch 68/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0355

Epoch 00068: loss improved from 0.03584 to 0.03552, saving model to ./model_0.hdf5
Epoch 69/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0350

Epoch 00069: loss improved from 0.03552 to 0.03495, saving model to ./model_0.hdf5
Epoch 70/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0343

Epoch 00070: loss improved from 0.03495 to 0.03425, saving model to ./model_0.hdf5
Epoch 71/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0341

Epoch 00071: loss improved from 0.03425 to 0.03410, saving model to ./model_0.hdf5
Epoch 72/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0334

Epoch 00072: loss improved from 0.03410 to 0.03345, saving model to ./model_0.hdf5
Epoch 73/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0348

Epoch 00073: loss did not improve from 0.03345
Epoch 74/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0332

Epoch 00074: loss improved from 0.03345 to 0.03316, saving model to ./model_0.hdf5
Epoch 75/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0325

Epoch 00075: loss improved from 0.03316 to 0.03247, saving model to ./model_0.hdf5
Epoch 76/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0327

Epoch 00076: loss did not improve from 0.03247
Epoch 77/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0323

Epoch 00077: loss improved from 0.03247 to 0.03228, saving model to ./model_0.hdf5
Epoch 78/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0323

Epoch 00078: loss did not improve from 0.03228
Epoch 79/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0324

Epoch 00079: loss did not improve from 0.03228
Epoch 80/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0320

Epoch 00080: loss improved from 0.03228 to 0.03200, saving model to ./model_0.hdf5
Epoch 81/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0315

Epoch 00081: loss improved from 0.03200 to 0.03150, saving model to ./model_0.hdf5
Epoch 82/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0316

Epoch 00082: loss did not improve from 0.03150
Epoch 83/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0320

Epoch 00083: loss did not improve from 0.03150
Epoch 84/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0313

Epoch 00084: loss improved from 0.03150 to 0.03125, saving model to ./model_0.hdf5
Epoch 85/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0314

Epoch 00085: loss did not improve from 0.03125
Epoch 86/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0311

Epoch 00086: loss improved from 0.03125 to 0.03109, saving model to ./model_0.hdf5
Epoch 87/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0309

Epoch 00087: loss improved from 0.03109 to 0.03093, saving model to ./model_0.hdf5
Epoch 88/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0306

Epoch 00088: loss improved from 0.03093 to 0.03057, saving model to ./model_0.hdf5
Epoch 89/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0309

Epoch 00089: loss did not improve from 0.03057
Epoch 90/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0305

Epoch 00090: loss improved from 0.03057 to 0.03051, saving model to ./model_0.hdf5
Epoch 91/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0299

Epoch 00091: loss improved from 0.03051 to 0.02987, saving model to ./model_0.hdf5
Epoch 92/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0293

Epoch 00092: loss improved from 0.02987 to 0.02933, saving model to ./model_0.hdf5
Epoch 93/1000
16/16 [==============================] - 1s 51ms/step - loss: 0.0291

Epoch 00093: loss improved from 0.02933 to 0.02909, saving model to ./model_0.hdf5
Epoch 94/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0295

Epoch 00094: loss did not improve from 0.02909
Epoch 95/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0296

Epoch 00095: loss did not improve from 0.02909
Epoch 96/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0286

Epoch 00096: loss improved from 0.02909 to 0.02862, saving model to ./model_0.hdf5
Epoch 97/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0299

Epoch 00097: loss did not improve from 0.02862
Epoch 98/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0313

Epoch 00098: loss did not improve from 0.02862
Epoch 99/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0308

Epoch 00099: loss did not improve from 0.02862
Epoch 100/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0296

Epoch 00100: loss did not improve from 0.02862
Epoch 101/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0287

Epoch 00101: loss did not improve from 0.02862
Epoch 102/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0284

Epoch 00102: loss improved from 0.02862 to 0.02836, saving model to ./model_0.hdf5
Epoch 103/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0293

Epoch 00103: loss did not improve from 0.02836
Epoch 104/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0306

Epoch 00104: loss did not improve from 0.02836
Epoch 105/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0295

Epoch 00105: loss did not improve from 0.02836
Epoch 106/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0286

Epoch 00106: loss did not improve from 0.02836
Epoch 107/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0280

Epoch 00107: loss improved from 0.02836 to 0.02797, saving model to ./model_0.hdf5
Epoch 108/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0288

Epoch 00108: loss did not improve from 0.02797
Epoch 109/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0280

Epoch 00109: loss improved from 0.02797 to 0.02796, saving model to ./model_0.hdf5
Epoch 110/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0289

Epoch 00110: loss did not improve from 0.02796
Epoch 111/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0277

Epoch 00111: loss improved from 0.02796 to 0.02770, saving model to ./model_0.hdf5
Epoch 112/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0273

Epoch 00112: loss improved from 0.02770 to 0.02728, saving model to ./model_0.hdf5
Epoch 113/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0282

Epoch 00113: loss did not improve from 0.02728
Epoch 114/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0282

Epoch 00114: loss did not improve from 0.02728
Epoch 115/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0294

Epoch 00115: loss did not improve from 0.02728
Epoch 116/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0283

Epoch 00116: loss did not improve from 0.02728
Epoch 117/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0280

Epoch 00117: loss did not improve from 0.02728
Epoch 118/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0293

Epoch 00118: loss did not improve from 0.02728
Epoch 119/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0284

Epoch 00119: loss did not improve from 0.02728
Epoch 120/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0278

Epoch 00120: loss did not improve from 0.02728
Epoch 121/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0277

Epoch 00121: loss did not improve from 0.02728
Epoch 122/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0271

Epoch 00122: loss improved from 0.02728 to 0.02708, saving model to ./model_0.hdf5
Epoch 123/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0288

Epoch 00123: loss did not improve from 0.02708
Epoch 124/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0279

Epoch 00124: loss did not improve from 0.02708
Epoch 125/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0288

Epoch 00125: loss did not improve from 0.02708
Epoch 126/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0278

Epoch 00126: loss did not improve from 0.02708
Epoch 127/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0270

Epoch 00127: loss improved from 0.02708 to 0.02695, saving model to ./model_0.hdf5
Epoch 128/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0266

Epoch 00128: loss improved from 0.02695 to 0.02665, saving model to ./model_0.hdf5
Epoch 129/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0284

Epoch 00129: loss did not improve from 0.02665
Epoch 130/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0280

Epoch 00130: loss did not improve from 0.02665
Epoch 131/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0274

Epoch 00131: loss did not improve from 0.02665
Epoch 132/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0287

Epoch 00132: loss did not improve from 0.02665
Epoch 133/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0273

Epoch 00133: loss did not improve from 0.02665
Epoch 134/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0279

Epoch 00134: loss did not improve from 0.02665
Epoch 135/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0281

Epoch 00135: loss did not improve from 0.02665
Epoch 136/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0278

Epoch 00136: loss did not improve from 0.02665
Epoch 137/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0276

Epoch 00137: loss did not improve from 0.02665
Epoch 138/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0273

Epoch 00138: loss did not improve from 0.02665
Epoch 139/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0274

Epoch 00139: loss did not improve from 0.02665
Epoch 140/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0263

Epoch 00140: loss improved from 0.02665 to 0.02633, saving model to ./model_0.hdf5
Epoch 141/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0273

Epoch 00141: loss did not improve from 0.02633
Epoch 142/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0278

Epoch 00142: loss did not improve from 0.02633
Epoch 143/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0260

Epoch 00143: loss improved from 0.02633 to 0.02597, saving model to ./model_0.hdf5
Epoch 144/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0269

Epoch 00144: loss did not improve from 0.02597
Epoch 145/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0282

Epoch 00145: loss did not improve from 0.02597
Epoch 146/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0264

Epoch 00146: loss did not improve from 0.02597
Epoch 147/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0268

Epoch 00147: loss did not improve from 0.02597
Epoch 148/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0269

Epoch 00148: loss did not improve from 0.02597
Epoch 149/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0266

Epoch 00149: loss did not improve from 0.02597
Epoch 150/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0274

Epoch 00150: loss did not improve from 0.02597
Epoch 151/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0269

Epoch 00151: loss did not improve from 0.02597
Epoch 152/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0270

Epoch 00152: loss did not improve from 0.02597
Epoch 153/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0267

Epoch 00153: loss did not improve from 0.02597
Epoch 154/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0293

Epoch 00154: loss did not improve from 0.02597
Epoch 155/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0267

Epoch 00155: loss did not improve from 0.02597
Epoch 156/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0274

Epoch 00156: loss did not improve from 0.02597
Epoch 157/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0295

Epoch 00157: loss did not improve from 0.02597
Epoch 158/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0262

Epoch 00158: loss did not improve from 0.02597
Epoch 159/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0269

Epoch 00159: loss did not improve from 0.02597
Epoch 160/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0263

Epoch 00160: loss did not improve from 0.02597
Epoch 161/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0265

Epoch 00161: loss did not improve from 0.02597
Epoch 162/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0248

Epoch 00162: loss improved from 0.02597 to 0.02477, saving model to ./model_0.hdf5
Epoch 163/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0261

Epoch 00163: loss did not improve from 0.02477
Epoch 164/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0270

Epoch 00164: loss did not improve from 0.02477
Epoch 165/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0252

Epoch 00165: loss did not improve from 0.02477
Epoch 166/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0259

Epoch 00166: loss did not improve from 0.02477
Epoch 167/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0254

Epoch 00167: loss did not improve from 0.02477
Epoch 168/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0245

Epoch 00168: loss improved from 0.02477 to 0.02447, saving model to ./model_0.hdf5
Epoch 169/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0249

Epoch 00169: loss did not improve from 0.02447
Epoch 170/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0266

Epoch 00170: loss did not improve from 0.02447
Epoch 171/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0256

Epoch 00171: loss did not improve from 0.02447
Epoch 172/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0254

Epoch 00172: loss did not improve from 0.02447
Epoch 173/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0276

Epoch 00173: loss did not improve from 0.02447
Epoch 174/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0271

Epoch 00174: loss did not improve from 0.02447
Epoch 175/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0252

Epoch 00175: loss did not improve from 0.02447
Epoch 176/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0258

Epoch 00176: loss did not improve from 0.02447
Epoch 177/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0254

Epoch 00177: loss did not improve from 0.02447
Epoch 178/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0255

Epoch 00178: loss did not improve from 0.02447
Epoch 179/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0258

Epoch 00179: loss did not improve from 0.02447
Epoch 180/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0263

Epoch 00180: loss did not improve from 0.02447
Epoch 181/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0265

Epoch 00181: loss did not improve from 0.02447
Epoch 182/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0250

Epoch 00182: loss did not improve from 0.02447
Epoch 183/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0254

Epoch 00183: loss did not improve from 0.02447
Epoch 184/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0266

Epoch 00184: loss did not improve from 0.02447
Epoch 185/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0255

Epoch 00185: loss did not improve from 0.02447
Epoch 186/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0262

Epoch 00186: loss did not improve from 0.02447
Epoch 187/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0265

Epoch 00187: loss did not improve from 0.02447
Epoch 188/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0254

Epoch 00188: loss did not improve from 0.02447
Epoch 189/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0245

Epoch 00189: loss improved from 0.02447 to 0.02445, saving model to ./model_0.hdf5
Epoch 190/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0250

Epoch 00190: loss did not improve from 0.02445
Epoch 191/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0253

Epoch 00191: loss did not improve from 0.02445
Epoch 192/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0257

Epoch 00192: loss did not improve from 0.02445
Epoch 193/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0246

Epoch 00193: loss did not improve from 0.02445

Epoch 00193: ReduceLROnPlateau reducing learning rate to 0.0010000000474974513.
Epoch 194/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0242

Epoch 00194: loss improved from 0.02445 to 0.02420, saving model to ./model_0.hdf5
Epoch 195/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0246

Epoch 00195: loss did not improve from 0.02420
Epoch 196/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0238

Epoch 00196: loss improved from 0.02420 to 0.02378, saving model to ./model_0.hdf5
Epoch 197/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0246

Epoch 00197: loss did not improve from 0.02378
Epoch 198/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0267

Epoch 00198: loss did not improve from 0.02378
Epoch 199/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0257

Epoch 00199: loss did not improve from 0.02378
Epoch 200/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0254

Epoch 00200: loss did not improve from 0.02378
Epoch 201/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0246

Epoch 00201: loss did not improve from 0.02378
Epoch 202/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0246

Epoch 00202: loss did not improve from 0.02378
Epoch 203/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0241

Epoch 00203: loss did not improve from 0.02378
Epoch 204/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0262

Epoch 00204: loss did not improve from 0.02378
Epoch 205/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0236

Epoch 00205: loss improved from 0.02378 to 0.02362, saving model to ./model_0.hdf5
Epoch 206/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0237

Epoch 00206: loss did not improve from 0.02362
Epoch 207/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0237

Epoch 00207: loss did not improve from 0.02362
Epoch 208/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0252

Epoch 00208: loss did not improve from 0.02362
Epoch 209/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0244

Epoch 00209: loss did not improve from 0.02362
Epoch 210/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0251

Epoch 00210: loss did not improve from 0.02362
Epoch 211/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0254

Epoch 00211: loss did not improve from 0.02362
Epoch 212/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0244

Epoch 00212: loss did not improve from 0.02362
Epoch 213/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0240

Epoch 00213: loss did not improve from 0.02362
Epoch 214/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0235

Epoch 00214: loss improved from 0.02362 to 0.02350, saving model to ./model_0.hdf5
Epoch 215/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0239

Epoch 00215: loss did not improve from 0.02350
Epoch 216/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0256

Epoch 00216: loss did not improve from 0.02350
Epoch 217/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0238

Epoch 00217: loss did not improve from 0.02350
Epoch 218/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0243

Epoch 00218: loss did not improve from 0.02350
Epoch 219/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0244

Epoch 00219: loss did not improve from 0.02350
Epoch 220/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0240

Epoch 00220: loss did not improve from 0.02350
Epoch 221/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0227

Epoch 00221: loss improved from 0.02350 to 0.02266, saving model to ./model_0.hdf5
Epoch 222/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0233

Epoch 00222: loss did not improve from 0.02266
Epoch 223/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0237

Epoch 00223: loss did not improve from 0.02266
Epoch 224/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0242

Epoch 00224: loss did not improve from 0.02266
Epoch 225/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0245

Epoch 00225: loss did not improve from 0.02266
Epoch 226/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0237

Epoch 00226: loss did not improve from 0.02266
Epoch 227/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0234

Epoch 00227: loss did not improve from 0.02266
Epoch 228/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0231

Epoch 00228: loss did not improve from 0.02266
Epoch 229/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0255

Epoch 00229: loss did not improve from 0.02266
Epoch 230/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0239

Epoch 00230: loss did not improve from 0.02266
Epoch 231/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0247

Epoch 00231: loss did not improve from 0.02266
Epoch 232/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0231

Epoch 00232: loss did not improve from 0.02266
Epoch 233/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0244

Epoch 00233: loss did not improve from 0.02266
Epoch 234/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0252

Epoch 00234: loss did not improve from 0.02266
Epoch 235/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0248

Epoch 00235: loss did not improve from 0.02266
Epoch 236/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0234

Epoch 00236: loss did not improve from 0.02266
Epoch 237/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0234

Epoch 00237: loss did not improve from 0.02266
Epoch 238/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0253

Epoch 00238: loss did not improve from 0.02266
Epoch 239/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0243

Epoch 00239: loss did not improve from 0.02266
Epoch 240/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0250

Epoch 00240: loss did not improve from 0.02266
Epoch 241/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0241

Epoch 00241: loss did not improve from 0.02266
Epoch 242/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0232

Epoch 00242: loss did not improve from 0.02266
Epoch 243/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0253

Epoch 00243: loss did not improve from 0.02266
Epoch 244/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0254

Epoch 00244: loss did not improve from 0.02266
Epoch 245/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0235

Epoch 00245: loss did not improve from 0.02266
Epoch 246/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0226

Epoch 00246: loss improved from 0.02266 to 0.02257, saving model to ./model_0.hdf5

Epoch 00246: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.
Epoch 247/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0234

Epoch 00247: loss did not improve from 0.02257
Epoch 248/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0230

Epoch 00248: loss did not improve from 0.02257
Epoch 249/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0237

Epoch 00249: loss did not improve from 0.02257
Epoch 250/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0235

Epoch 00250: loss did not improve from 0.02257
Epoch 251/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0232

Epoch 00251: loss did not improve from 0.02257
Epoch 252/1000
16/16 [==============================] - 1s 51ms/step - loss: 0.0235

Epoch 00252: loss did not improve from 0.02257
Epoch 253/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0242

Epoch 00253: loss did not improve from 0.02257
Epoch 254/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0237

Epoch 00254: loss did not improve from 0.02257
Epoch 255/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0229

Epoch 00255: loss did not improve from 0.02257
Epoch 256/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0245

Epoch 00256: loss did not improve from 0.02257
Epoch 257/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0242

Epoch 00257: loss did not improve from 0.02257
Epoch 258/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0235

Epoch 00258: loss did not improve from 0.02257
Epoch 259/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0237

Epoch 00259: loss did not improve from 0.02257
Epoch 260/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0240

Epoch 00260: loss did not improve from 0.02257
Epoch 261/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0232

Epoch 00261: loss did not improve from 0.02257
Epoch 262/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0231

Epoch 00262: loss did not improve from 0.02257
Epoch 263/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0247

Epoch 00263: loss did not improve from 0.02257
Epoch 264/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0233

Epoch 00264: loss did not improve from 0.02257
Epoch 265/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0238

Epoch 00265: loss did not improve from 0.02257
Epoch 266/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0240

Epoch 00266: loss did not improve from 0.02257
Epoch 267/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0233

Epoch 00267: loss did not improve from 0.02257
Epoch 268/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0233

Epoch 00268: loss did not improve from 0.02257
Epoch 269/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0227

Epoch 00269: loss did not improve from 0.02257
Epoch 270/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0234

Epoch 00270: loss did not improve from 0.02257
Epoch 271/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0229

Epoch 00271: loss did not improve from 0.02257

Epoch 00271: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.
Epoch 272/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0222

Epoch 00272: loss improved from 0.02257 to 0.02216, saving model to ./model_0.hdf5
Epoch 273/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0242

Epoch 00273: loss did not improve from 0.02216
Epoch 274/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0237

Epoch 00274: loss did not improve from 0.02216
Epoch 275/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0245

Epoch 00275: loss did not improve from 0.02216
Epoch 276/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0241

Epoch 00276: loss did not improve from 0.02216
Epoch 277/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0231

Epoch 00277: loss did not improve from 0.02216
Epoch 278/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0227

Epoch 00278: loss did not improve from 0.02216
Epoch 279/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0239

Epoch 00279: loss did not improve from 0.02216
Epoch 280/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0235

Epoch 00280: loss did not improve from 0.02216
Epoch 281/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0237

Epoch 00281: loss did not improve from 0.02216
Epoch 282/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0221

Epoch 00282: loss improved from 0.02216 to 0.02206, saving model to ./model_0.hdf5
Epoch 283/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0243

Epoch 00283: loss did not improve from 0.02206
Epoch 284/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0226

Epoch 00284: loss did not improve from 0.02206
Epoch 285/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0227

Epoch 00285: loss did not improve from 0.02206
Epoch 286/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0228

Epoch 00286: loss did not improve from 0.02206
Epoch 287/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0221

Epoch 00287: loss did not improve from 0.02206
Epoch 288/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0228

Epoch 00288: loss did not improve from 0.02206
Epoch 289/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0223

Epoch 00289: loss did not improve from 0.02206
Epoch 290/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0230

Epoch 00290: loss did not improve from 0.02206
Epoch 291/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0229

Epoch 00291: loss did not improve from 0.02206
Epoch 292/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0220

Epoch 00292: loss improved from 0.02206 to 0.02205, saving model to ./model_0.hdf5
Epoch 293/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0237

Epoch 00293: loss did not improve from 0.02205
Epoch 294/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0238

Epoch 00294: loss did not improve from 0.02205
Epoch 295/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0229

Epoch 00295: loss did not improve from 0.02205
Epoch 296/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0231

Epoch 00296: loss did not improve from 0.02205
Epoch 297/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0236

Epoch 00297: loss did not improve from 0.02205
Epoch 298/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0229

Epoch 00298: loss did not improve from 0.02205
Epoch 299/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0232

Epoch 00299: loss did not improve from 0.02205
Epoch 300/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0231

Epoch 00300: loss did not improve from 0.02205
Epoch 301/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0229

Epoch 00301: loss did not improve from 0.02205
Epoch 302/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0234

Epoch 00302: loss did not improve from 0.02205
Epoch 303/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0227

Epoch 00303: loss did not improve from 0.02205
Epoch 304/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0237

Epoch 00304: loss did not improve from 0.02205
Epoch 305/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0227

Epoch 00305: loss did not improve from 0.02205
Epoch 306/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0231

Epoch 00306: loss did not improve from 0.02205
Epoch 307/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0225

Epoch 00307: loss did not improve from 0.02205

Epoch 00307: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.
Epoch 308/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0233

Epoch 00308: loss did not improve from 0.02205
Epoch 309/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0233

Epoch 00309: loss did not improve from 0.02205
Epoch 310/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0230

Epoch 00310: loss did not improve from 0.02205
Epoch 311/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0230

Epoch 00311: loss did not improve from 0.02205
Epoch 312/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0219

Epoch 00312: loss improved from 0.02205 to 0.02193, saving model to ./model_0.hdf5
Epoch 313/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0228

Epoch 00313: loss did not improve from 0.02193
Epoch 314/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0226

Epoch 00314: loss did not improve from 0.02193
Epoch 315/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0235

Epoch 00315: loss did not improve from 0.02193
Epoch 316/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0247

Epoch 00316: loss did not improve from 0.02193
Epoch 317/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0243

Epoch 00317: loss did not improve from 0.02193
Epoch 318/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0233

Epoch 00318: loss did not improve from 0.02193
Epoch 319/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0233

Epoch 00319: loss did not improve from 0.02193
Epoch 320/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0231

Epoch 00320: loss did not improve from 0.02193
Epoch 321/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0224

Epoch 00321: loss did not improve from 0.02193
Epoch 322/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0229

Epoch 00322: loss did not improve from 0.02193
Epoch 323/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0224

Epoch 00323: loss did not improve from 0.02193
Epoch 324/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0226

Epoch 00324: loss did not improve from 0.02193
Epoch 325/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0225

Epoch 00325: loss did not improve from 0.02193
Epoch 326/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0231

Epoch 00326: loss did not improve from 0.02193
Epoch 327/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0237

Epoch 00327: loss did not improve from 0.02193
Epoch 328/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0234

Epoch 00328: loss did not improve from 0.02193
Epoch 329/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0227

Epoch 00329: loss did not improve from 0.02193
Epoch 330/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0227

Epoch 00330: loss did not improve from 0.02193
Epoch 331/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0222

Epoch 00331: loss did not improve from 0.02193
Epoch 332/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0236

Epoch 00332: loss did not improve from 0.02193
Epoch 333/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0238

Epoch 00333: loss did not improve from 0.02193
Epoch 334/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0223

Epoch 00334: loss did not improve from 0.02193
Epoch 335/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0240

Epoch 00335: loss did not improve from 0.02193
Epoch 336/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0244

Epoch 00336: loss did not improve from 0.02193
Epoch 337/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0227

Epoch 00337: loss did not improve from 0.02193

Epoch 00337: ReduceLROnPlateau reducing learning rate to 6.25000029685907e-05.
Epoch 338/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0219

Epoch 00338: loss did not improve from 0.02193
Epoch 339/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0231

Epoch 00339: loss did not improve from 0.02193
Epoch 340/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0232

Epoch 00340: loss did not improve from 0.02193
Epoch 341/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0220

Epoch 00341: loss did not improve from 0.02193
Epoch 342/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0236

Epoch 00342: loss did not improve from 0.02193
Epoch 343/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0222

Epoch 00343: loss did not improve from 0.02193
Epoch 344/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0221

Epoch 00344: loss did not improve from 0.02193
Epoch 345/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0225

Epoch 00345: loss did not improve from 0.02193
Epoch 346/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0239

Epoch 00346: loss did not improve from 0.02193
Epoch 347/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0229

Epoch 00347: loss did not improve from 0.02193
Epoch 348/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0225

Epoch 00348: loss did not improve from 0.02193
Epoch 349/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0223

Epoch 00349: loss did not improve from 0.02193
Epoch 350/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0225

Epoch 00350: loss did not improve from 0.02193
Epoch 351/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0224

Epoch 00351: loss did not improve from 0.02193
Epoch 352/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0222

Epoch 00352: loss did not improve from 0.02193
Epoch 353/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0232

Epoch 00353: loss did not improve from 0.02193
Epoch 354/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0227

Epoch 00354: loss did not improve from 0.02193
Epoch 355/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0224

Epoch 00355: loss did not improve from 0.02193
Epoch 356/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0242

Epoch 00356: loss did not improve from 0.02193
Epoch 357/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0224

Epoch 00357: loss did not improve from 0.02193
Epoch 358/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0221

Epoch 00358: loss did not improve from 0.02193
Epoch 359/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0252

Epoch 00359: loss did not improve from 0.02193
Epoch 360/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0228

Epoch 00360: loss did not improve from 0.02193
Epoch 361/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0234

Epoch 00361: loss did not improve from 0.02193
Epoch 362/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0227

Epoch 00362: loss did not improve from 0.02193

Epoch 00362: ReduceLROnPlateau reducing learning rate to 3.125000148429535e-05.
Epoch 00362: early stopping
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="examine-the-results">
<h3>Examine the results<a class="headerlink" href="#examine-the-results" title="Permalink to this headline">¶</a></h3>
<p>Let’s load the best model and test it on a frame first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model_0</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;model_0.hdf5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">edit_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
      <span class="n">layer</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">layer</span><span class="o">.</span><span class="n">_name</span> 
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model_0</span><span class="o">.</span><span class="n">weights</span><span class="p">)):</span>
      <span class="n">model_0</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_handle_name</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">model_0</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">edit_name</span><span class="p">(</span><span class="n">model_0</span><span class="p">,</span> <span class="s1">&#39;model_0&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">1430</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<span class="n">img_rec</span> <span class="o">=</span> <span class="n">model_0</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">img</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span><span class="o">...</span><span class="p">])</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_rec</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/pca_ae_hierarchy_17_0.png" src="../_images/pca_ae_hierarchy_17_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">decoder_0</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">model_0</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="o">-</span><span class="mi">12</span><span class="p">:])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)):</span>
    <span class="n">img_dec</span> <span class="o">=</span> <span class="n">decoder_0</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_dec</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;z=(</span><span class="si">{</span><span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">, 0)&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/pca_ae_hierarchy_19_0.png" src="../_images/pca_ae_hierarchy_19_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model_0</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model: &quot;model&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
model_0_input_1 (InputLayer) [(None, 64, 64, 1)]       0         
_________________________________________________________________
model_0_conv2d (Conv2D)      (None, 64, 64, 4)         40        
_________________________________________________________________
model_0_leaky_re_lu (LeakyRe (None, 64, 64, 4)         0         
_________________________________________________________________
model_0_max_pooling2d (MaxPo (None, 32, 32, 4)         0         
_________________________________________________________________
model_0_conv2d_1 (Conv2D)    (None, 32, 32, 8)         296       
_________________________________________________________________
model_0_leaky_re_lu_1 (Leaky (None, 32, 32, 8)         0         
_________________________________________________________________
model_0_max_pooling2d_1 (Max (None, 16, 16, 8)         0         
_________________________________________________________________
model_0_conv2d_2 (Conv2D)    (None, 16, 16, 16)        1168      
_________________________________________________________________
model_0_leaky_re_lu_2 (Leaky (None, 16, 16, 16)        0         
_________________________________________________________________
model_0_max_pooling2d_2 (Max (None, 8, 8, 16)          0         
_________________________________________________________________
model_0_conv2d_3 (Conv2D)    (None, 8, 8, 32)          4640      
_________________________________________________________________
model_0_leaky_re_lu_3 (Leaky (None, 8, 8, 32)          0         
_________________________________________________________________
model_0_max_pooling2d_3 (Max (None, 4, 4, 32)          0         
_________________________________________________________________
model_0_conv2d_4 (Conv2D)    (None, 4, 4, 64)          18496     
_________________________________________________________________
model_0_leaky_re_lu_4 (Leaky (None, 4, 4, 64)          0         
_________________________________________________________________
model_0_max_pooling2d_4 (Max (None, 2, 2, 64)          0         
_________________________________________________________________
model_0_flatten (Flatten)    (None, 256)               0         
_________________________________________________________________
model_0_batch_normalization  (None, 256)               512       
_________________________________________________________________
model_0_dense (Dense)        (None, 1)                 257       
_________________________________________________________________
model_0_leaky_re_lu_5 (Leaky (None, 1)                 0         
_________________________________________________________________
model_0_dense_1 (Dense)      (None, 16)                32        
_________________________________________________________________
model_0_leaky_re_lu_6 (Leaky (None, 16)                0         
_________________________________________________________________
model_0_reshape (Reshape)    (None, 2, 2, 4)           0         
_________________________________________________________________
model_0_conv2d_transpose (Co (None, 4, 4, 32)          1184      
_________________________________________________________________
model_0_leaky_re_lu_7 (Leaky (None, 4, 4, 32)          0         
_________________________________________________________________
model_0_conv2d_transpose_1 ( (None, 8, 8, 16)          4624      
_________________________________________________________________
model_0_leaky_re_lu_8 (Leaky (None, 8, 8, 16)          0         
_________________________________________________________________
model_0_conv2d_transpose_2 ( (None, 16, 16, 8)         1160      
_________________________________________________________________
model_0_leaky_re_lu_9 (Leaky (None, 16, 16, 8)         0         
_________________________________________________________________
model_0_conv2d_transpose_3 ( (None, 32, 32, 4)         292       
_________________________________________________________________
model_0_leaky_re_lu_10 (Leak (None, 32, 32, 4)         0         
_________________________________________________________________
model_0_conv2d_transpose_4 ( (None, 64, 64, 1)         37        
=================================================================
Total params: 32,738
Trainable params: 32,226
Non-trainable params: 512
_________________________________________________________________
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="autoencoder-2">
<h2>Autoencoder 2<a class="headerlink" href="#autoencoder-2" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>
<span class="n">encoder_0</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">model_0</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">model_0</span><span class="o">.</span><span class="n">get_layer</span><span class="p">(</span><span class="s1">&#39;model_0_leaky_re_lu_5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
<span class="n">encoder_0</span><span class="o">.</span><span class="n">trainable</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">input_img</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">encoded_1</span> <span class="o">=</span> <span class="n">encoder_gen</span><span class="p">(</span><span class="n">input_img</span><span class="p">)</span>
<span class="n">encoded_0</span> <span class="o">=</span> <span class="n">encoder_0</span><span class="p">(</span><span class="n">input_img</span><span class="p">)</span>
<span class="n">concat</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Concatenate</span><span class="p">()([</span><span class="n">encoded_1</span><span class="p">,</span> <span class="n">encoded_0</span><span class="p">])</span>
<span class="c1">#activated = keras.layers.LeakyReLU()(concat)</span>
<span class="n">add_loss</span> <span class="o">=</span> <span class="n">LatentCovarianceLayer</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)(</span><span class="n">concat</span><span class="p">)</span>
<span class="n">decoded_1</span> <span class="o">=</span> <span class="n">decoder_gen</span><span class="p">(</span><span class="n">add_loss</span><span class="p">)</span>
<span class="n">pca_ae</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">input_img</span><span class="p">,</span> <span class="n">decoded_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pca_ae</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model: &quot;model_1&quot;
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 64, 64, 1)]  0                                            
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 64, 64, 4)    40          input_1[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu (LeakyReLU)         (None, 64, 64, 4)    0           conv2d[0][0]                     
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 32, 32, 4)    0           leaky_re_lu[0][0]                
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 8)    296         max_pooling2d[0][0]              
__________________________________________________________________________________________________
leaky_re_lu_1 (LeakyReLU)       (None, 32, 32, 8)    0           conv2d_1[0][0]                   
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 16, 8)    0           leaky_re_lu_1[0][0]              
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 16, 16, 16)   1168        max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_2 (LeakyReLU)       (None, 16, 16, 16)   0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 8, 8, 16)     0           leaky_re_lu_2[0][0]              
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 8, 8, 32)     4640        max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_3 (LeakyReLU)       (None, 8, 8, 32)     0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 4, 4, 32)     0           leaky_re_lu_3[0][0]              
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 4, 4, 64)     18496       max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_4 (LeakyReLU)       (None, 4, 4, 64)     0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 2, 2, 64)     0           leaky_re_lu_4[0][0]              
__________________________________________________________________________________________________
flatten (Flatten)               (None, 256)          0           max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 256)          512         flatten[0][0]                    
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            257         batch_normalization[0][0]        
__________________________________________________________________________________________________
leaky_re_lu_5 (LeakyReLU)       (None, 1)            0           dense[0][0]                      
__________________________________________________________________________________________________
model (Functional)              (None, 1)            25409       input_1[0][0]                    
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 2)            0           leaky_re_lu_5[0][0]              
                                                                 model[0][0]                      
__________________________________________________________________________________________________
latent_covariance_layer (Latent (None, 2)            0           concatenate[0][0]                
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 16)           48          latent_covariance_layer[0][0]    
__________________________________________________________________________________________________
leaky_re_lu_6 (LeakyReLU)       (None, 16)           0           dense_1[0][0]                    
__________________________________________________________________________________________________
reshape (Reshape)               (None, 2, 2, 4)      0           leaky_re_lu_6[0][0]              
__________________________________________________________________________________________________
conv2d_transpose (Conv2DTranspo (None, 4, 4, 32)     1184        reshape[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu_7 (LeakyReLU)       (None, 4, 4, 32)     0           conv2d_transpose[0][0]           
__________________________________________________________________________________________________
conv2d_transpose_1 (Conv2DTrans (None, 8, 8, 16)     4624        leaky_re_lu_7[0][0]              
__________________________________________________________________________________________________
leaky_re_lu_8 (LeakyReLU)       (None, 8, 8, 16)     0           conv2d_transpose_1[0][0]         
__________________________________________________________________________________________________
conv2d_transpose_2 (Conv2DTrans (None, 16, 16, 8)    1160        leaky_re_lu_8[0][0]              
__________________________________________________________________________________________________
leaky_re_lu_9 (LeakyReLU)       (None, 16, 16, 8)    0           conv2d_transpose_2[0][0]         
__________________________________________________________________________________________________
conv2d_transpose_3 (Conv2DTrans (None, 32, 32, 4)    292         leaky_re_lu_9[0][0]              
__________________________________________________________________________________________________
leaky_re_lu_10 (LeakyReLU)      (None, 32, 32, 4)    0           conv2d_transpose_3[0][0]         
__________________________________________________________________________________________________
conv2d_transpose_4 (Conv2DTrans (None, 64, 64, 1)    37          leaky_re_lu_10[0][0]             
==================================================================================================
Total params: 58,163
Trainable params: 32,242
Non-trainable params: 25,921
__________________________________________________________________________________________________
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.002</span><span class="p">)</span>
<span class="n">pca_ae</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>

<span class="n">tempfn</span><span class="o">=</span><span class="s1">&#39;./model_1.hdf5&#39;</span>
<span class="n">model_cb</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ModelCheckpoint</span><span class="p">(</span><span class="n">tempfn</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span><span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">early_cb</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">learning_rate_reduction</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span>
                                                            <span class="n">patience</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
                                                            <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                                            <span class="n">factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                                            <span class="n">min_lr</span><span class="o">=</span><span class="mf">0.00001</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_cb</span><span class="p">,</span> <span class="n">early_cb</span><span class="p">,</span> <span class="n">learning_rate_reduction</span><span class="p">]</span>

<span class="n">history</span><span class="o">=</span><span class="n">pca_ae</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span>
                   <span class="n">epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                   <span class="n">batch_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
                   <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">callbacks</span><span class="o">=</span><span class="n">cb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/1000
16/16 [==============================] - 3s 73ms/step - loss: 1.1478

Epoch 00001: loss improved from inf to 1.14783, saving model to ./model_1.hdf5
Epoch 2/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.3879

Epoch 00002: loss improved from 1.14783 to 0.38786, saving model to ./model_1.hdf5
Epoch 3/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.1822

Epoch 00003: loss improved from 0.38786 to 0.18221, saving model to ./model_1.hdf5
Epoch 4/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.1264

Epoch 00004: loss improved from 0.18221 to 0.12637, saving model to ./model_1.hdf5
Epoch 5/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.1027

Epoch 00005: loss improved from 0.12637 to 0.10266, saving model to ./model_1.hdf5
Epoch 6/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0898

Epoch 00006: loss improved from 0.10266 to 0.08980, saving model to ./model_1.hdf5
Epoch 7/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0814

Epoch 00007: loss improved from 0.08980 to 0.08141, saving model to ./model_1.hdf5
Epoch 8/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0819

Epoch 00008: loss did not improve from 0.08141
Epoch 9/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0762

Epoch 00009: loss improved from 0.08141 to 0.07618, saving model to ./model_1.hdf5
Epoch 10/1000
16/16 [==============================] - 1s 62ms/step - loss: 0.0678

Epoch 00010: loss improved from 0.07618 to 0.06784, saving model to ./model_1.hdf5
Epoch 11/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0669

Epoch 00011: loss improved from 0.06784 to 0.06686, saving model to ./model_1.hdf5
Epoch 12/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0630

Epoch 00012: loss improved from 0.06686 to 0.06299, saving model to ./model_1.hdf5
Epoch 13/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0657

Epoch 00013: loss did not improve from 0.06299
Epoch 14/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0575

Epoch 00014: loss improved from 0.06299 to 0.05746, saving model to ./model_1.hdf5
Epoch 15/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0592

Epoch 00015: loss did not improve from 0.05746
Epoch 16/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0548

Epoch 00016: loss improved from 0.05746 to 0.05480, saving model to ./model_1.hdf5
Epoch 17/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0471

Epoch 00017: loss improved from 0.05480 to 0.04708, saving model to ./model_1.hdf5
Epoch 18/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0464

Epoch 00018: loss improved from 0.04708 to 0.04644, saving model to ./model_1.hdf5
Epoch 19/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0447

Epoch 00019: loss improved from 0.04644 to 0.04470, saving model to ./model_1.hdf5
Epoch 20/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0462

Epoch 00020: loss did not improve from 0.04470
Epoch 21/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0471

Epoch 00021: loss did not improve from 0.04470
Epoch 22/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0466

Epoch 00022: loss did not improve from 0.04470
Epoch 23/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0436

Epoch 00023: loss improved from 0.04470 to 0.04356, saving model to ./model_1.hdf5
Epoch 24/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0427

Epoch 00024: loss improved from 0.04356 to 0.04268, saving model to ./model_1.hdf5
Epoch 25/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0404

Epoch 00025: loss improved from 0.04268 to 0.04040, saving model to ./model_1.hdf5
Epoch 26/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0414

Epoch 00026: loss did not improve from 0.04040
Epoch 27/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0395

Epoch 00027: loss improved from 0.04040 to 0.03947, saving model to ./model_1.hdf5
Epoch 28/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0381

Epoch 00028: loss improved from 0.03947 to 0.03811, saving model to ./model_1.hdf5
Epoch 29/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0403

Epoch 00029: loss did not improve from 0.03811
Epoch 30/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0380

Epoch 00030: loss improved from 0.03811 to 0.03799, saving model to ./model_1.hdf5
Epoch 31/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0379

Epoch 00031: loss improved from 0.03799 to 0.03786, saving model to ./model_1.hdf5
Epoch 32/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0407

Epoch 00032: loss did not improve from 0.03786
Epoch 33/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0377

Epoch 00033: loss improved from 0.03786 to 0.03773, saving model to ./model_1.hdf5
Epoch 34/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0387

Epoch 00034: loss did not improve from 0.03773
Epoch 35/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0358

Epoch 00035: loss improved from 0.03773 to 0.03575, saving model to ./model_1.hdf5
Epoch 36/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0368

Epoch 00036: loss did not improve from 0.03575
Epoch 37/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0379

Epoch 00037: loss did not improve from 0.03575
Epoch 38/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0363

Epoch 00038: loss did not improve from 0.03575
Epoch 39/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0360

Epoch 00039: loss did not improve from 0.03575
Epoch 40/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0344

Epoch 00040: loss improved from 0.03575 to 0.03439, saving model to ./model_1.hdf5
Epoch 41/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0356

Epoch 00041: loss did not improve from 0.03439
Epoch 42/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0341

Epoch 00042: loss improved from 0.03439 to 0.03410, saving model to ./model_1.hdf5
Epoch 43/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0327

Epoch 00043: loss improved from 0.03410 to 0.03274, saving model to ./model_1.hdf5
Epoch 44/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0331

Epoch 00044: loss did not improve from 0.03274
Epoch 45/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0357

Epoch 00045: loss did not improve from 0.03274
Epoch 46/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0343

Epoch 00046: loss did not improve from 0.03274
Epoch 47/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0356

Epoch 00047: loss did not improve from 0.03274
Epoch 48/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0328

Epoch 00048: loss did not improve from 0.03274
Epoch 49/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0321

Epoch 00049: loss improved from 0.03274 to 0.03213, saving model to ./model_1.hdf5
Epoch 50/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0315

Epoch 00050: loss improved from 0.03213 to 0.03147, saving model to ./model_1.hdf5
Epoch 51/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0311

Epoch 00051: loss improved from 0.03147 to 0.03107, saving model to ./model_1.hdf5
Epoch 52/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0310

Epoch 00052: loss improved from 0.03107 to 0.03096, saving model to ./model_1.hdf5
Epoch 53/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0308

Epoch 00053: loss improved from 0.03096 to 0.03083, saving model to ./model_1.hdf5
Epoch 54/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0309

Epoch 00054: loss did not improve from 0.03083
Epoch 55/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0305

Epoch 00055: loss improved from 0.03083 to 0.03054, saving model to ./model_1.hdf5
Epoch 56/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0317

Epoch 00056: loss did not improve from 0.03054
Epoch 57/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0314

Epoch 00057: loss did not improve from 0.03054
Epoch 58/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0305

Epoch 00058: loss did not improve from 0.03054
Epoch 59/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0305

Epoch 00059: loss improved from 0.03054 to 0.03051, saving model to ./model_1.hdf5
Epoch 60/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0307

Epoch 00060: loss did not improve from 0.03051
Epoch 61/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0296

Epoch 00061: loss improved from 0.03051 to 0.02962, saving model to ./model_1.hdf5
Epoch 62/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0293

Epoch 00062: loss improved from 0.02962 to 0.02934, saving model to ./model_1.hdf5
Epoch 63/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0293

Epoch 00063: loss improved from 0.02934 to 0.02934, saving model to ./model_1.hdf5
Epoch 64/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0293

Epoch 00064: loss improved from 0.02934 to 0.02928, saving model to ./model_1.hdf5
Epoch 65/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0285

Epoch 00065: loss improved from 0.02928 to 0.02847, saving model to ./model_1.hdf5
Epoch 66/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0281

Epoch 00066: loss improved from 0.02847 to 0.02807, saving model to ./model_1.hdf5
Epoch 67/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0292

Epoch 00067: loss did not improve from 0.02807
Epoch 68/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0291

Epoch 00068: loss did not improve from 0.02807
Epoch 69/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0282

Epoch 00069: loss did not improve from 0.02807
Epoch 70/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0294

Epoch 00070: loss did not improve from 0.02807
Epoch 71/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0294

Epoch 00071: loss did not improve from 0.02807
Epoch 72/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0275

Epoch 00072: loss improved from 0.02807 to 0.02753, saving model to ./model_1.hdf5
Epoch 73/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0302

Epoch 00073: loss did not improve from 0.02753
Epoch 74/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0274

Epoch 00074: loss improved from 0.02753 to 0.02740, saving model to ./model_1.hdf5
Epoch 75/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0275

Epoch 00075: loss did not improve from 0.02740
Epoch 76/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0276

Epoch 00076: loss did not improve from 0.02740
Epoch 77/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0277

Epoch 00077: loss did not improve from 0.02740
Epoch 78/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0269

Epoch 00078: loss improved from 0.02740 to 0.02686, saving model to ./model_1.hdf5
Epoch 79/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0273

Epoch 00079: loss did not improve from 0.02686
Epoch 80/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0286

Epoch 00080: loss did not improve from 0.02686
Epoch 81/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0280

Epoch 00081: loss did not improve from 0.02686
Epoch 82/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0264

Epoch 00082: loss improved from 0.02686 to 0.02640, saving model to ./model_1.hdf5
Epoch 83/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0271

Epoch 00083: loss did not improve from 0.02640
Epoch 84/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0268

Epoch 00084: loss did not improve from 0.02640
Epoch 85/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0263

Epoch 00085: loss improved from 0.02640 to 0.02625, saving model to ./model_1.hdf5
Epoch 86/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0266

Epoch 00086: loss did not improve from 0.02625
Epoch 87/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0266

Epoch 00087: loss did not improve from 0.02625
Epoch 88/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0261

Epoch 00088: loss improved from 0.02625 to 0.02608, saving model to ./model_1.hdf5
Epoch 89/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0266

Epoch 00089: loss did not improve from 0.02608
Epoch 90/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0259

Epoch 00090: loss improved from 0.02608 to 0.02593, saving model to ./model_1.hdf5
Epoch 91/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0258

Epoch 00091: loss improved from 0.02593 to 0.02577, saving model to ./model_1.hdf5
Epoch 92/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0260

Epoch 00092: loss did not improve from 0.02577
Epoch 93/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0258

Epoch 00093: loss did not improve from 0.02577
Epoch 94/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0260

Epoch 00094: loss did not improve from 0.02577
Epoch 95/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0260

Epoch 00095: loss did not improve from 0.02577
Epoch 96/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0256

Epoch 00096: loss improved from 0.02577 to 0.02559, saving model to ./model_1.hdf5
Epoch 97/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0249

Epoch 00097: loss improved from 0.02559 to 0.02485, saving model to ./model_1.hdf5
Epoch 98/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0250

Epoch 00098: loss did not improve from 0.02485
Epoch 99/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0257

Epoch 00099: loss did not improve from 0.02485
Epoch 100/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0246

Epoch 00100: loss improved from 0.02485 to 0.02462, saving model to ./model_1.hdf5
Epoch 101/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0252

Epoch 00101: loss did not improve from 0.02462
Epoch 102/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0258

Epoch 00102: loss did not improve from 0.02462
Epoch 103/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0252

Epoch 00103: loss did not improve from 0.02462
Epoch 104/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0255

Epoch 00104: loss did not improve from 0.02462
Epoch 105/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0249

Epoch 00105: loss did not improve from 0.02462
Epoch 106/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0242

Epoch 00106: loss improved from 0.02462 to 0.02424, saving model to ./model_1.hdf5
Epoch 107/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0249

Epoch 00107: loss did not improve from 0.02424
Epoch 108/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0242

Epoch 00108: loss improved from 0.02424 to 0.02424, saving model to ./model_1.hdf5
Epoch 109/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0250

Epoch 00109: loss did not improve from 0.02424
Epoch 110/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0246

Epoch 00110: loss did not improve from 0.02424
Epoch 111/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0236

Epoch 00111: loss improved from 0.02424 to 0.02363, saving model to ./model_1.hdf5
Epoch 112/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0248

Epoch 00112: loss did not improve from 0.02363
Epoch 113/1000
16/16 [==============================] - 1s 62ms/step - loss: 0.0239

Epoch 00113: loss did not improve from 0.02363
Epoch 114/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0235

Epoch 00114: loss improved from 0.02363 to 0.02350, saving model to ./model_1.hdf5
Epoch 115/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0234

Epoch 00115: loss improved from 0.02350 to 0.02341, saving model to ./model_1.hdf5
Epoch 116/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0233

Epoch 00116: loss improved from 0.02341 to 0.02330, saving model to ./model_1.hdf5
Epoch 117/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0237

Epoch 00117: loss did not improve from 0.02330
Epoch 118/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0236

Epoch 00118: loss did not improve from 0.02330
Epoch 119/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0231

Epoch 00119: loss improved from 0.02330 to 0.02313, saving model to ./model_1.hdf5
Epoch 120/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0232

Epoch 00120: loss did not improve from 0.02313
Epoch 121/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0243

Epoch 00121: loss did not improve from 0.02313
Epoch 122/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0234

Epoch 00122: loss did not improve from 0.02313
Epoch 123/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0228

Epoch 00123: loss improved from 0.02313 to 0.02277, saving model to ./model_1.hdf5
Epoch 124/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0225

Epoch 00124: loss improved from 0.02277 to 0.02252, saving model to ./model_1.hdf5
Epoch 125/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0228

Epoch 00125: loss did not improve from 0.02252
Epoch 126/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0232

Epoch 00126: loss did not improve from 0.02252
Epoch 127/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0228

Epoch 00127: loss did not improve from 0.02252
Epoch 128/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0226

Epoch 00128: loss did not improve from 0.02252
Epoch 129/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0230

Epoch 00129: loss did not improve from 0.02252
Epoch 130/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0222

Epoch 00130: loss improved from 0.02252 to 0.02224, saving model to ./model_1.hdf5
Epoch 131/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0224

Epoch 00131: loss did not improve from 0.02224
Epoch 132/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0231

Epoch 00132: loss did not improve from 0.02224
Epoch 133/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0225

Epoch 00133: loss did not improve from 0.02224
Epoch 134/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0219

Epoch 00134: loss improved from 0.02224 to 0.02186, saving model to ./model_1.hdf5
Epoch 135/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0225

Epoch 00135: loss did not improve from 0.02186
Epoch 136/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0230

Epoch 00136: loss did not improve from 0.02186
Epoch 137/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0219

Epoch 00137: loss did not improve from 0.02186
Epoch 138/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0219

Epoch 00138: loss did not improve from 0.02186
Epoch 139/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0220

Epoch 00139: loss did not improve from 0.02186
Epoch 140/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0220

Epoch 00140: loss did not improve from 0.02186
Epoch 141/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0218

Epoch 00141: loss improved from 0.02186 to 0.02182, saving model to ./model_1.hdf5
Epoch 142/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0220

Epoch 00142: loss did not improve from 0.02182
Epoch 143/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0217

Epoch 00143: loss improved from 0.02182 to 0.02170, saving model to ./model_1.hdf5
Epoch 144/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0220

Epoch 00144: loss did not improve from 0.02170
Epoch 145/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0222

Epoch 00145: loss did not improve from 0.02170
Epoch 146/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0214

Epoch 00146: loss improved from 0.02170 to 0.02137, saving model to ./model_1.hdf5
Epoch 147/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0219

Epoch 00147: loss did not improve from 0.02137
Epoch 148/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0216

Epoch 00148: loss did not improve from 0.02137
Epoch 149/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0220

Epoch 00149: loss did not improve from 0.02137
Epoch 150/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0214

Epoch 00150: loss did not improve from 0.02137
Epoch 151/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0222

Epoch 00151: loss did not improve from 0.02137
Epoch 152/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0233

Epoch 00152: loss did not improve from 0.02137
Epoch 153/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0217

Epoch 00153: loss did not improve from 0.02137
Epoch 154/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0216

Epoch 00154: loss did not improve from 0.02137
Epoch 155/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0214

Epoch 00155: loss did not improve from 0.02137
Epoch 156/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0217

Epoch 00156: loss did not improve from 0.02137
Epoch 157/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0210

Epoch 00157: loss improved from 0.02137 to 0.02097, saving model to ./model_1.hdf5
Epoch 158/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0207

Epoch 00158: loss improved from 0.02097 to 0.02068, saving model to ./model_1.hdf5
Epoch 159/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0211

Epoch 00159: loss did not improve from 0.02068
Epoch 160/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0213

Epoch 00160: loss did not improve from 0.02068
Epoch 161/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0211

Epoch 00161: loss did not improve from 0.02068
Epoch 162/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0206

Epoch 00162: loss improved from 0.02068 to 0.02064, saving model to ./model_1.hdf5
Epoch 163/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0213

Epoch 00163: loss did not improve from 0.02064
Epoch 164/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0211

Epoch 00164: loss did not improve from 0.02064
Epoch 165/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0215

Epoch 00165: loss did not improve from 0.02064
Epoch 166/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0208

Epoch 00166: loss did not improve from 0.02064
Epoch 167/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0210

Epoch 00167: loss did not improve from 0.02064
Epoch 168/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0204

Epoch 00168: loss improved from 0.02064 to 0.02037, saving model to ./model_1.hdf5
Epoch 169/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0207

Epoch 00169: loss did not improve from 0.02037
Epoch 170/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0211

Epoch 00170: loss did not improve from 0.02037
Epoch 171/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0206

Epoch 00171: loss did not improve from 0.02037
Epoch 172/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0208

Epoch 00172: loss did not improve from 0.02037
Epoch 173/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0210

Epoch 00173: loss did not improve from 0.02037
Epoch 174/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0207

Epoch 00174: loss did not improve from 0.02037
Epoch 175/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0208

Epoch 00175: loss did not improve from 0.02037
Epoch 176/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0208

Epoch 00176: loss did not improve from 0.02037
Epoch 177/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0209

Epoch 00177: loss did not improve from 0.02037
Epoch 178/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0203

Epoch 00178: loss improved from 0.02037 to 0.02031, saving model to ./model_1.hdf5
Epoch 179/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0207

Epoch 00179: loss did not improve from 0.02031
Epoch 180/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0206

Epoch 00180: loss did not improve from 0.02031
Epoch 181/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0210

Epoch 00181: loss did not improve from 0.02031
Epoch 182/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0206

Epoch 00182: loss did not improve from 0.02031
Epoch 183/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0208

Epoch 00183: loss did not improve from 0.02031
Epoch 184/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0207

Epoch 00184: loss did not improve from 0.02031
Epoch 185/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0202

Epoch 00185: loss improved from 0.02031 to 0.02023, saving model to ./model_1.hdf5
Epoch 186/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0203

Epoch 00186: loss did not improve from 0.02023
Epoch 187/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0209

Epoch 00187: loss did not improve from 0.02023
Epoch 188/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0215

Epoch 00188: loss did not improve from 0.02023
Epoch 189/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0210

Epoch 00189: loss did not improve from 0.02023
Epoch 190/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0203

Epoch 00190: loss did not improve from 0.02023
Epoch 191/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0203

Epoch 00191: loss did not improve from 0.02023
Epoch 192/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0207

Epoch 00192: loss did not improve from 0.02023
Epoch 193/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0206

Epoch 00193: loss did not improve from 0.02023
Epoch 194/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0206

Epoch 00194: loss did not improve from 0.02023
Epoch 195/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0205

Epoch 00195: loss did not improve from 0.02023
Epoch 196/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0206

Epoch 00196: loss did not improve from 0.02023
Epoch 197/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0203

Epoch 00197: loss did not improve from 0.02023
Epoch 198/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0201

Epoch 00198: loss improved from 0.02023 to 0.02014, saving model to ./model_1.hdf5
Epoch 199/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0201

Epoch 00199: loss improved from 0.02014 to 0.02012, saving model to ./model_1.hdf5
Epoch 200/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0206

Epoch 00200: loss did not improve from 0.02012
Epoch 201/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0205

Epoch 00201: loss did not improve from 0.02012
Epoch 202/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0206

Epoch 00202: loss did not improve from 0.02012
Epoch 203/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0201

Epoch 00203: loss improved from 0.02012 to 0.02007, saving model to ./model_1.hdf5
Epoch 204/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0203

Epoch 00204: loss did not improve from 0.02007
Epoch 205/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0200

Epoch 00205: loss improved from 0.02007 to 0.01997, saving model to ./model_1.hdf5
Epoch 206/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0197

Epoch 00206: loss improved from 0.01997 to 0.01973, saving model to ./model_1.hdf5
Epoch 207/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0196

Epoch 00207: loss improved from 0.01973 to 0.01957, saving model to ./model_1.hdf5
Epoch 208/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0202

Epoch 00208: loss did not improve from 0.01957
Epoch 209/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0204

Epoch 00209: loss did not improve from 0.01957
Epoch 210/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0212

Epoch 00210: loss did not improve from 0.01957
Epoch 211/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0205

Epoch 00211: loss did not improve from 0.01957
Epoch 212/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0202

Epoch 00212: loss did not improve from 0.01957
Epoch 213/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0201

Epoch 00213: loss did not improve from 0.01957
Epoch 214/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0195

Epoch 00214: loss improved from 0.01957 to 0.01954, saving model to ./model_1.hdf5
Epoch 215/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0202

Epoch 00215: loss did not improve from 0.01954
Epoch 216/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0203

Epoch 00216: loss did not improve from 0.01954
Epoch 217/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0209

Epoch 00217: loss did not improve from 0.01954
Epoch 218/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0207

Epoch 00218: loss did not improve from 0.01954
Epoch 219/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0209

Epoch 00219: loss did not improve from 0.01954
Epoch 220/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0202

Epoch 00220: loss did not improve from 0.01954
Epoch 221/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0205

Epoch 00221: loss did not improve from 0.01954
Epoch 222/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0201

Epoch 00222: loss did not improve from 0.01954
Epoch 223/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0204

Epoch 00223: loss did not improve from 0.01954
Epoch 224/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0198

Epoch 00224: loss did not improve from 0.01954
Epoch 225/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0199

Epoch 00225: loss did not improve from 0.01954
Epoch 226/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0202

Epoch 00226: loss did not improve from 0.01954
Epoch 227/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0204

Epoch 00227: loss did not improve from 0.01954
Epoch 228/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0200

Epoch 00228: loss did not improve from 0.01954
Epoch 229/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0204

Epoch 00229: loss did not improve from 0.01954
Epoch 230/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0204

Epoch 00230: loss did not improve from 0.01954
Epoch 231/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0199

Epoch 00231: loss did not improve from 0.01954
Epoch 232/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0195

Epoch 00232: loss did not improve from 0.01954

Epoch 00232: ReduceLROnPlateau reducing learning rate to 0.0010000000474974513.
Epoch 233/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0195

Epoch 00233: loss improved from 0.01954 to 0.01945, saving model to ./model_1.hdf5
Epoch 234/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0191

Epoch 00234: loss improved from 0.01945 to 0.01914, saving model to ./model_1.hdf5
Epoch 235/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0192

Epoch 00235: loss did not improve from 0.01914
Epoch 236/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0191

Epoch 00236: loss improved from 0.01914 to 0.01913, saving model to ./model_1.hdf5
Epoch 237/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0192

Epoch 00237: loss did not improve from 0.01913
Epoch 238/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0193

Epoch 00238: loss did not improve from 0.01913
Epoch 239/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0191

Epoch 00239: loss improved from 0.01913 to 0.01908, saving model to ./model_1.hdf5
Epoch 240/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0191

Epoch 00240: loss did not improve from 0.01908
Epoch 241/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0192

Epoch 00241: loss did not improve from 0.01908
Epoch 242/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0189

Epoch 00242: loss improved from 0.01908 to 0.01887, saving model to ./model_1.hdf5
Epoch 243/1000
16/16 [==============================] - 1s 62ms/step - loss: 0.0192

Epoch 00243: loss did not improve from 0.01887
Epoch 244/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0192

Epoch 00244: loss did not improve from 0.01887
Epoch 245/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0192

Epoch 00245: loss did not improve from 0.01887
Epoch 246/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0190

Epoch 00246: loss did not improve from 0.01887
Epoch 247/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0191

Epoch 00247: loss did not improve from 0.01887
Epoch 248/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0191

Epoch 00248: loss did not improve from 0.01887
Epoch 249/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0189

Epoch 00249: loss did not improve from 0.01887
Epoch 250/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0189

Epoch 00250: loss did not improve from 0.01887
Epoch 251/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0190

Epoch 00251: loss did not improve from 0.01887
Epoch 252/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0189

Epoch 00252: loss did not improve from 0.01887
Epoch 253/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0191

Epoch 00253: loss did not improve from 0.01887
Epoch 254/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0189

Epoch 00254: loss did not improve from 0.01887
Epoch 255/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0188

Epoch 00255: loss improved from 0.01887 to 0.01884, saving model to ./model_1.hdf5
Epoch 256/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0189

Epoch 00256: loss did not improve from 0.01884
Epoch 257/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0188

Epoch 00257: loss improved from 0.01884 to 0.01877, saving model to ./model_1.hdf5
Epoch 258/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0189

Epoch 00258: loss did not improve from 0.01877
Epoch 259/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0191

Epoch 00259: loss did not improve from 0.01877
Epoch 260/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0193

Epoch 00260: loss did not improve from 0.01877
Epoch 261/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0189

Epoch 00261: loss did not improve from 0.01877
Epoch 262/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0187

Epoch 00262: loss improved from 0.01877 to 0.01873, saving model to ./model_1.hdf5
Epoch 263/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0192

Epoch 00263: loss did not improve from 0.01873
Epoch 264/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0188

Epoch 00264: loss did not improve from 0.01873
Epoch 265/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0189

Epoch 00265: loss did not improve from 0.01873
Epoch 266/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0191

Epoch 00266: loss did not improve from 0.01873
Epoch 267/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0191

Epoch 00267: loss did not improve from 0.01873
Epoch 268/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0188

Epoch 00268: loss did not improve from 0.01873
Epoch 269/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0188

Epoch 00269: loss did not improve from 0.01873
Epoch 270/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0190

Epoch 00270: loss did not improve from 0.01873
Epoch 271/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0189

Epoch 00271: loss did not improve from 0.01873
Epoch 272/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0189

Epoch 00272: loss did not improve from 0.01873
Epoch 273/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0190

Epoch 00273: loss did not improve from 0.01873
Epoch 274/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0188

Epoch 00274: loss did not improve from 0.01873
Epoch 275/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0188

Epoch 00275: loss did not improve from 0.01873
Epoch 276/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0188

Epoch 00276: loss did not improve from 0.01873
Epoch 277/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0191

Epoch 00277: loss did not improve from 0.01873
Epoch 278/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0190

Epoch 00278: loss did not improve from 0.01873
Epoch 279/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0191

Epoch 00279: loss did not improve from 0.01873
Epoch 280/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0190

Epoch 00280: loss did not improve from 0.01873
Epoch 281/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0189

Epoch 00281: loss did not improve from 0.01873
Epoch 282/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0187

Epoch 00282: loss improved from 0.01873 to 0.01872, saving model to ./model_1.hdf5
Epoch 283/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0191

Epoch 00283: loss did not improve from 0.01872
Epoch 284/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0191

Epoch 00284: loss did not improve from 0.01872
Epoch 285/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0189

Epoch 00285: loss did not improve from 0.01872
Epoch 286/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0187

Epoch 00286: loss improved from 0.01872 to 0.01869, saving model to ./model_1.hdf5
Epoch 287/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0189

Epoch 00287: loss did not improve from 0.01869

Epoch 00287: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.
Epoch 288/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0185

Epoch 00288: loss improved from 0.01869 to 0.01854, saving model to ./model_1.hdf5
Epoch 289/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0185

Epoch 00289: loss improved from 0.01854 to 0.01849, saving model to ./model_1.hdf5
Epoch 290/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0186

Epoch 00290: loss did not improve from 0.01849
Epoch 291/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0187

Epoch 00291: loss did not improve from 0.01849
Epoch 292/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0186

Epoch 00292: loss did not improve from 0.01849
Epoch 293/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0186

Epoch 00293: loss did not improve from 0.01849
Epoch 294/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0187

Epoch 00294: loss did not improve from 0.01849
Epoch 295/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0186

Epoch 00295: loss did not improve from 0.01849
Epoch 296/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0184

Epoch 00296: loss improved from 0.01849 to 0.01841, saving model to ./model_1.hdf5
Epoch 297/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0185

Epoch 00297: loss did not improve from 0.01841
Epoch 298/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0186

Epoch 00298: loss did not improve from 0.01841
Epoch 299/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0186

Epoch 00299: loss did not improve from 0.01841
Epoch 300/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0184

Epoch 00300: loss did not improve from 0.01841
Epoch 301/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0184

Epoch 00301: loss improved from 0.01841 to 0.01839, saving model to ./model_1.hdf5
Epoch 302/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0184

Epoch 00302: loss improved from 0.01839 to 0.01838, saving model to ./model_1.hdf5
Epoch 303/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0185

Epoch 00303: loss did not improve from 0.01838
Epoch 304/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0186

Epoch 00304: loss did not improve from 0.01838
Epoch 305/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0185

Epoch 00305: loss did not improve from 0.01838
Epoch 306/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0184

Epoch 00306: loss did not improve from 0.01838
Epoch 307/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0184

Epoch 00307: loss improved from 0.01838 to 0.01835, saving model to ./model_1.hdf5
Epoch 308/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0185

Epoch 00308: loss did not improve from 0.01835
Epoch 309/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0185

Epoch 00309: loss did not improve from 0.01835
Epoch 310/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0186

Epoch 00310: loss did not improve from 0.01835
Epoch 311/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0185

Epoch 00311: loss did not improve from 0.01835
Epoch 312/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0185

Epoch 00312: loss did not improve from 0.01835
Epoch 313/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0185

Epoch 00313: loss did not improve from 0.01835
Epoch 314/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0184

Epoch 00314: loss did not improve from 0.01835
Epoch 315/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0186

Epoch 00315: loss did not improve from 0.01835
Epoch 316/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0185

Epoch 00316: loss did not improve from 0.01835
Epoch 317/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0185

Epoch 00317: loss did not improve from 0.01835
Epoch 318/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0185

Epoch 00318: loss did not improve from 0.01835
Epoch 319/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0185

Epoch 00319: loss did not improve from 0.01835
Epoch 320/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0185

Epoch 00320: loss did not improve from 0.01835
Epoch 321/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0185

Epoch 00321: loss did not improve from 0.01835

Epoch 00321: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.
Epoch 322/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0184

Epoch 00322: loss did not improve from 0.01835
Epoch 323/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0183

Epoch 00323: loss improved from 0.01835 to 0.01831, saving model to ./model_1.hdf5
Epoch 324/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0183

Epoch 00324: loss improved from 0.01831 to 0.01829, saving model to ./model_1.hdf5
Epoch 325/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0183

Epoch 00325: loss improved from 0.01829 to 0.01827, saving model to ./model_1.hdf5
Epoch 326/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0183

Epoch 00326: loss did not improve from 0.01827
Epoch 327/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0184

Epoch 00327: loss did not improve from 0.01827
Epoch 328/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0182

Epoch 00328: loss improved from 0.01827 to 0.01822, saving model to ./model_1.hdf5
Epoch 329/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0183

Epoch 00329: loss did not improve from 0.01822
Epoch 330/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0182

Epoch 00330: loss did not improve from 0.01822
Epoch 331/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0182

Epoch 00331: loss improved from 0.01822 to 0.01820, saving model to ./model_1.hdf5
Epoch 332/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0183

Epoch 00332: loss did not improve from 0.01820
Epoch 333/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0183

Epoch 00333: loss did not improve from 0.01820
Epoch 334/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0183

Epoch 00334: loss did not improve from 0.01820
Epoch 335/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0183

Epoch 00335: loss did not improve from 0.01820
Epoch 336/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0183

Epoch 00336: loss did not improve from 0.01820
Epoch 337/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0182

Epoch 00337: loss improved from 0.01820 to 0.01820, saving model to ./model_1.hdf5
Epoch 338/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0182

Epoch 00338: loss did not improve from 0.01820
Epoch 339/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0183

Epoch 00339: loss did not improve from 0.01820
Epoch 340/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0184

Epoch 00340: loss did not improve from 0.01820
Epoch 341/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0184

Epoch 00341: loss did not improve from 0.01820
Epoch 342/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0184

Epoch 00342: loss did not improve from 0.01820
Epoch 343/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0184

Epoch 00343: loss did not improve from 0.01820
Epoch 344/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0183

Epoch 00344: loss did not improve from 0.01820
Epoch 345/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0183

Epoch 00345: loss did not improve from 0.01820
Epoch 346/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0182

Epoch 00346: loss did not improve from 0.01820
Epoch 347/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0183

Epoch 00347: loss did not improve from 0.01820
Epoch 348/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0182

Epoch 00348: loss did not improve from 0.01820
Epoch 349/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0182

Epoch 00349: loss did not improve from 0.01820

Epoch 00349: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.
Epoch 350/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00350: loss improved from 0.01820 to 0.01812, saving model to ./model_1.hdf5
Epoch 351/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0182

Epoch 00351: loss did not improve from 0.01812
Epoch 352/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0182

Epoch 00352: loss did not improve from 0.01812
Epoch 353/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0181

Epoch 00353: loss did not improve from 0.01812
Epoch 354/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0183

Epoch 00354: loss did not improve from 0.01812
Epoch 355/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0182

Epoch 00355: loss did not improve from 0.01812
Epoch 356/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00356: loss did not improve from 0.01812
Epoch 357/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0182

Epoch 00357: loss did not improve from 0.01812
Epoch 358/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0182

Epoch 00358: loss did not improve from 0.01812
Epoch 359/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0182

Epoch 00359: loss did not improve from 0.01812
Epoch 360/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0181

Epoch 00360: loss did not improve from 0.01812
Epoch 361/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00361: loss did not improve from 0.01812
Epoch 362/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0182

Epoch 00362: loss did not improve from 0.01812
Epoch 363/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0181

Epoch 00363: loss did not improve from 0.01812
Epoch 364/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0181

Epoch 00364: loss did not improve from 0.01812
Epoch 365/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00365: loss did not improve from 0.01812
Epoch 366/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0182

Epoch 00366: loss did not improve from 0.01812
Epoch 367/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0182

Epoch 00367: loss did not improve from 0.01812
Epoch 368/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0181

Epoch 00368: loss improved from 0.01812 to 0.01807, saving model to ./model_1.hdf5
Epoch 369/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00369: loss did not improve from 0.01807
Epoch 370/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0182

Epoch 00370: loss did not improve from 0.01807
Epoch 371/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0181

Epoch 00371: loss did not improve from 0.01807
Epoch 372/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0182

Epoch 00372: loss did not improve from 0.01807
Epoch 373/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00373: loss did not improve from 0.01807
Epoch 374/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0182

Epoch 00374: loss did not improve from 0.01807
Epoch 375/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0182

Epoch 00375: loss did not improve from 0.01807

Epoch 00375: ReduceLROnPlateau reducing learning rate to 6.25000029685907e-05.
Epoch 376/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0181

Epoch 00376: loss did not improve from 0.01807
Epoch 377/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0182

Epoch 00377: loss did not improve from 0.01807
Epoch 378/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0181

Epoch 00378: loss did not improve from 0.01807
Epoch 379/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00379: loss improved from 0.01807 to 0.01802, saving model to ./model_1.hdf5
Epoch 380/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00380: loss did not improve from 0.01802
Epoch 381/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0181

Epoch 00381: loss did not improve from 0.01802
Epoch 382/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00382: loss did not improve from 0.01802
Epoch 383/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0182

Epoch 00383: loss did not improve from 0.01802
Epoch 384/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00384: loss did not improve from 0.01802
Epoch 385/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0182

Epoch 00385: loss did not improve from 0.01802
Epoch 386/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00386: loss did not improve from 0.01802
Epoch 387/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0181

Epoch 00387: loss did not improve from 0.01802
Epoch 388/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00388: loss did not improve from 0.01802
Epoch 389/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00389: loss did not improve from 0.01802
Epoch 390/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0181

Epoch 00390: loss did not improve from 0.01802
Epoch 391/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0181

Epoch 00391: loss did not improve from 0.01802
Epoch 392/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00392: loss did not improve from 0.01802
Epoch 393/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0182

Epoch 00393: loss did not improve from 0.01802
Epoch 394/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00394: loss did not improve from 0.01802
Epoch 395/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00395: loss did not improve from 0.01802
Epoch 396/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0181

Epoch 00396: loss did not improve from 0.01802
Epoch 397/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00397: loss did not improve from 0.01802
Epoch 398/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0181

Epoch 00398: loss did not improve from 0.01802
Epoch 399/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00399: loss did not improve from 0.01802
Epoch 400/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00400: loss did not improve from 0.01802

Epoch 00400: ReduceLROnPlateau reducing learning rate to 3.125000148429535e-05.
Epoch 401/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00401: loss did not improve from 0.01802
Epoch 402/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0180

Epoch 00402: loss did not improve from 0.01802
Epoch 403/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00403: loss improved from 0.01802 to 0.01801, saving model to ./model_1.hdf5
Epoch 404/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00404: loss did not improve from 0.01801
Epoch 405/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0180

Epoch 00405: loss did not improve from 0.01801
Epoch 406/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00406: loss did not improve from 0.01801
Epoch 407/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00407: loss did not improve from 0.01801
Epoch 408/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00408: loss did not improve from 0.01801
Epoch 409/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0181

Epoch 00409: loss did not improve from 0.01801
Epoch 410/1000
16/16 [==============================] - 1s 70ms/step - loss: 0.0181

Epoch 00410: loss did not improve from 0.01801
Epoch 411/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00411: loss did not improve from 0.01801
Epoch 412/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00412: loss did not improve from 0.01801
Epoch 413/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00413: loss did not improve from 0.01801
Epoch 414/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00414: loss did not improve from 0.01801
Epoch 415/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00415: loss did not improve from 0.01801
Epoch 416/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00416: loss did not improve from 0.01801
Epoch 417/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00417: loss did not improve from 0.01801
Epoch 418/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00418: loss did not improve from 0.01801
Epoch 419/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00419: loss improved from 0.01801 to 0.01800, saving model to ./model_1.hdf5
Epoch 420/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00420: loss did not improve from 0.01800
Epoch 421/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00421: loss did not improve from 0.01800
Epoch 422/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00422: loss did not improve from 0.01800
Epoch 423/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00423: loss did not improve from 0.01800
Epoch 424/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00424: loss did not improve from 0.01800
Epoch 425/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00425: loss did not improve from 0.01800
Epoch 426/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0180

Epoch 00426: loss did not improve from 0.01800
Epoch 427/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00427: loss did not improve from 0.01800
Epoch 428/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00428: loss did not improve from 0.01800

Epoch 00428: ReduceLROnPlateau reducing learning rate to 1.5625000742147677e-05.
Epoch 429/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00429: loss did not improve from 0.01800
Epoch 430/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00430: loss did not improve from 0.01800
Epoch 431/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00431: loss did not improve from 0.01800
Epoch 432/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0181

Epoch 00432: loss did not improve from 0.01800
Epoch 433/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00433: loss improved from 0.01800 to 0.01799, saving model to ./model_1.hdf5
Epoch 434/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00434: loss did not improve from 0.01799
Epoch 435/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0180

Epoch 00435: loss did not improve from 0.01799
Epoch 436/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00436: loss did not improve from 0.01799
Epoch 437/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00437: loss improved from 0.01799 to 0.01799, saving model to ./model_1.hdf5
Epoch 438/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0181

Epoch 00438: loss did not improve from 0.01799
Epoch 439/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00439: loss did not improve from 0.01799
Epoch 440/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00440: loss improved from 0.01799 to 0.01798, saving model to ./model_1.hdf5
Epoch 441/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00441: loss did not improve from 0.01798
Epoch 442/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00442: loss did not improve from 0.01798
Epoch 443/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0180

Epoch 00443: loss did not improve from 0.01798
Epoch 444/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00444: loss did not improve from 0.01798
Epoch 445/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00445: loss did not improve from 0.01798
Epoch 446/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00446: loss did not improve from 0.01798
Epoch 447/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00447: loss did not improve from 0.01798
Epoch 448/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00448: loss did not improve from 0.01798
Epoch 449/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00449: loss did not improve from 0.01798
Epoch 450/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00450: loss did not improve from 0.01798
Epoch 451/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00451: loss did not improve from 0.01798
Epoch 452/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0180

Epoch 00452: loss did not improve from 0.01798
Epoch 453/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00453: loss did not improve from 0.01798

Epoch 00453: ReduceLROnPlateau reducing learning rate to 1e-05.
Epoch 454/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00454: loss did not improve from 0.01798
Epoch 455/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00455: loss did not improve from 0.01798
Epoch 456/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00456: loss did not improve from 0.01798
Epoch 457/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00457: loss did not improve from 0.01798
Epoch 458/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0180

Epoch 00458: loss did not improve from 0.01798
Epoch 459/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00459: loss did not improve from 0.01798
Epoch 460/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00460: loss did not improve from 0.01798
Epoch 461/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0181

Epoch 00461: loss did not improve from 0.01798
Epoch 462/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00462: loss did not improve from 0.01798
Epoch 463/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0180

Epoch 00463: loss did not improve from 0.01798
Epoch 464/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0180

Epoch 00464: loss did not improve from 0.01798
Epoch 465/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00465: loss did not improve from 0.01798
Epoch 466/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00466: loss did not improve from 0.01798
Epoch 467/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00467: loss did not improve from 0.01798
Epoch 468/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0180

Epoch 00468: loss did not improve from 0.01798
Epoch 469/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00469: loss did not improve from 0.01798
Epoch 470/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0181

Epoch 00470: loss did not improve from 0.01798
Epoch 471/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00471: loss improved from 0.01798 to 0.01796, saving model to ./model_1.hdf5
Epoch 472/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00472: loss did not improve from 0.01796
Epoch 473/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00473: loss did not improve from 0.01796
Epoch 474/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00474: loss did not improve from 0.01796
Epoch 475/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00475: loss did not improve from 0.01796
Epoch 476/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00476: loss did not improve from 0.01796
Epoch 477/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00477: loss did not improve from 0.01796
Epoch 478/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0180

Epoch 00478: loss did not improve from 0.01796
Epoch 479/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0180

Epoch 00479: loss did not improve from 0.01796
Epoch 480/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00480: loss did not improve from 0.01796
Epoch 481/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00481: loss did not improve from 0.01796
Epoch 482/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00482: loss did not improve from 0.01796
Epoch 483/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0180

Epoch 00483: loss did not improve from 0.01796
Epoch 484/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00484: loss did not improve from 0.01796
Epoch 485/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00485: loss did not improve from 0.01796
Epoch 486/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0180

Epoch 00486: loss did not improve from 0.01796
Epoch 487/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00487: loss did not improve from 0.01796
Epoch 488/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0180

Epoch 00488: loss did not improve from 0.01796
Epoch 489/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0180

Epoch 00489: loss did not improve from 0.01796
Epoch 490/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00490: loss did not improve from 0.01796
Epoch 491/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00491: loss did not improve from 0.01796
Epoch 492/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00492: loss did not improve from 0.01796
Epoch 493/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00493: loss did not improve from 0.01796
Epoch 494/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00494: loss did not improve from 0.01796
Epoch 495/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00495: loss did not improve from 0.01796
Epoch 496/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00496: loss did not improve from 0.01796
Epoch 497/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00497: loss did not improve from 0.01796
Epoch 498/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00498: loss did not improve from 0.01796
Epoch 499/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00499: loss did not improve from 0.01796
Epoch 500/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00500: loss did not improve from 0.01796
Epoch 501/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0180

Epoch 00501: loss did not improve from 0.01796
Epoch 502/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00502: loss did not improve from 0.01796
Epoch 503/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00503: loss did not improve from 0.01796
Epoch 504/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0180

Epoch 00504: loss did not improve from 0.01796
Epoch 505/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00505: loss did not improve from 0.01796
Epoch 506/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00506: loss did not improve from 0.01796
Epoch 507/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00507: loss did not improve from 0.01796
Epoch 508/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00508: loss did not improve from 0.01796
Epoch 509/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00509: loss did not improve from 0.01796
Epoch 510/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00510: loss improved from 0.01796 to 0.01796, saving model to ./model_1.hdf5
Epoch 511/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00511: loss did not improve from 0.01796
Epoch 512/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00512: loss did not improve from 0.01796
Epoch 513/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00513: loss did not improve from 0.01796
Epoch 514/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0181

Epoch 00514: loss did not improve from 0.01796
Epoch 515/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00515: loss did not improve from 0.01796
Epoch 516/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0180

Epoch 00516: loss did not improve from 0.01796
Epoch 517/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00517: loss did not improve from 0.01796
Epoch 518/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0180

Epoch 00518: loss did not improve from 0.01796
Epoch 519/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00519: loss did not improve from 0.01796
Epoch 520/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00520: loss did not improve from 0.01796
Epoch 521/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0180

Epoch 00521: loss did not improve from 0.01796
Epoch 522/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00522: loss did not improve from 0.01796
Epoch 523/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0180

Epoch 00523: loss did not improve from 0.01796
Epoch 524/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0179

Epoch 00524: loss improved from 0.01796 to 0.01793, saving model to ./model_1.hdf5
Epoch 525/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00525: loss did not improve from 0.01793
Epoch 526/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00526: loss did not improve from 0.01793
Epoch 527/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00527: loss did not improve from 0.01793
Epoch 528/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00528: loss did not improve from 0.01793
Epoch 529/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00529: loss did not improve from 0.01793
Epoch 530/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0181

Epoch 00530: loss did not improve from 0.01793
Epoch 531/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0180

Epoch 00531: loss did not improve from 0.01793
Epoch 532/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00532: loss did not improve from 0.01793
Epoch 533/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0180

Epoch 00533: loss did not improve from 0.01793
Epoch 534/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00534: loss did not improve from 0.01793
Epoch 535/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0181

Epoch 00535: loss did not improve from 0.01793
Epoch 536/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0181

Epoch 00536: loss did not improve from 0.01793
Epoch 537/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00537: loss did not improve from 0.01793
Epoch 538/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00538: loss did not improve from 0.01793
Epoch 539/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00539: loss did not improve from 0.01793
Epoch 540/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00540: loss did not improve from 0.01793
Epoch 541/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00541: loss did not improve from 0.01793
Epoch 542/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00542: loss did not improve from 0.01793
Epoch 543/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0180

Epoch 00543: loss did not improve from 0.01793
Epoch 544/1000
16/16 [==============================] - 1s 64ms/step - loss: 0.0180

Epoch 00544: loss did not improve from 0.01793
Epoch 545/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0181

Epoch 00545: loss did not improve from 0.01793
Epoch 546/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00546: loss did not improve from 0.01793
Epoch 547/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0180

Epoch 00547: loss did not improve from 0.01793
Epoch 548/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00548: loss did not improve from 0.01793
Epoch 549/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00549: loss did not improve from 0.01793
Epoch 550/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00550: loss did not improve from 0.01793
Epoch 551/1000
16/16 [==============================] - 1s 70ms/step - loss: 0.0180

Epoch 00551: loss did not improve from 0.01793
Epoch 552/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00552: loss did not improve from 0.01793
Epoch 553/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00553: loss did not improve from 0.01793
Epoch 554/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00554: loss did not improve from 0.01793
Epoch 555/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00555: loss did not improve from 0.01793
Epoch 556/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00556: loss did not improve from 0.01793
Epoch 557/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00557: loss did not improve from 0.01793
Epoch 558/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00558: loss did not improve from 0.01793
Epoch 559/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00559: loss did not improve from 0.01793
Epoch 560/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00560: loss did not improve from 0.01793
Epoch 561/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0180

Epoch 00561: loss did not improve from 0.01793
Epoch 562/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0180

Epoch 00562: loss did not improve from 0.01793
Epoch 563/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00563: loss did not improve from 0.01793
Epoch 564/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00564: loss did not improve from 0.01793
Epoch 565/1000
16/16 [==============================] - 1s 68ms/step - loss: 0.0180

Epoch 00565: loss did not improve from 0.01793
Epoch 566/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0180

Epoch 00566: loss did not improve from 0.01793
Epoch 567/1000
16/16 [==============================] - 1s 66ms/step - loss: 0.0180

Epoch 00567: loss did not improve from 0.01793
Epoch 568/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00568: loss did not improve from 0.01793
Epoch 569/1000
16/16 [==============================] - 1s 70ms/step - loss: 0.0180

Epoch 00569: loss did not improve from 0.01793
Epoch 570/1000
16/16 [==============================] - 1s 63ms/step - loss: 0.0180

Epoch 00570: loss did not improve from 0.01793
Epoch 571/1000
16/16 [==============================] - 1s 69ms/step - loss: 0.0180

Epoch 00571: loss did not improve from 0.01793
Epoch 572/1000
16/16 [==============================] - 1s 65ms/step - loss: 0.0180

Epoch 00572: loss did not improve from 0.01793
Epoch 573/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0181

Epoch 00573: loss did not improve from 0.01793
Epoch 574/1000
16/16 [==============================] - 1s 67ms/step - loss: 0.0180

Epoch 00574: loss did not improve from 0.01793
Epoch 00574: early stopping
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model_1</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;model_1.hdf5&#39;</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;LatentCovarianceLayer&quot;</span><span class="p">:</span> <span class="n">LatentCovarianceLayer</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">1430</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<span class="n">img_rec</span> <span class="o">=</span> <span class="n">model_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">img</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span><span class="o">...</span><span class="p">])</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_rec</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/pca_ae_hierarchy_26_0.png" src="../_images/pca_ae_hierarchy_26_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pca_ae_decoder</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">model_1</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="o">-</span><span class="mi">12</span><span class="p">:])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pca_ae_encoder</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">pca_ae</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">pca_ae</span><span class="o">.</span><span class="n">get_layer</span><span class="p">(</span><span class="s1">&#39;concatenate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pca_ae_encoder</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model: &quot;model_2&quot;
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 64, 64, 1)]  0                                            
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 64, 64, 4)    40          input_1[0][0]                    
__________________________________________________________________________________________________
leaky_re_lu (LeakyReLU)         (None, 64, 64, 4)    0           conv2d[0][0]                     
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 32, 32, 4)    0           leaky_re_lu[0][0]                
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 32, 32, 8)    296         max_pooling2d[0][0]              
__________________________________________________________________________________________________
leaky_re_lu_1 (LeakyReLU)       (None, 32, 32, 8)    0           conv2d_1[0][0]                   
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 16, 8)    0           leaky_re_lu_1[0][0]              
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 16, 16, 16)   1168        max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_2 (LeakyReLU)       (None, 16, 16, 16)   0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 8, 8, 16)     0           leaky_re_lu_2[0][0]              
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 8, 8, 32)     4640        max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_3 (LeakyReLU)       (None, 8, 8, 32)     0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 4, 4, 32)     0           leaky_re_lu_3[0][0]              
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 4, 4, 64)     18496       max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
leaky_re_lu_4 (LeakyReLU)       (None, 4, 4, 64)     0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 2, 2, 64)     0           leaky_re_lu_4[0][0]              
__________________________________________________________________________________________________
flatten (Flatten)               (None, 256)          0           max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 256)          512         flatten[0][0]                    
__________________________________________________________________________________________________
dense (Dense)                   (None, 1)            257         batch_normalization[0][0]        
__________________________________________________________________________________________________
leaky_re_lu_5 (LeakyReLU)       (None, 1)            0           dense[0][0]                      
__________________________________________________________________________________________________
model (Functional)              (None, 1)            25409       input_1[0][0]                    
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 2)            0           leaky_re_lu_5[0][0]              
                                                                 model[0][0]                      
__________________________________________________________________________________________________
leaky_re_lu_6 (LeakyReLU)       (None, 2)            0           concatenate[0][0]                
__________________________________________________________________________________________________
latent_covariance_layer (Latent (None, 2)            0           leaky_re_lu_6[0][0]              
==================================================================================================
Total params: 50,818
Trainable params: 24,897
Non-trainable params: 25,921
__________________________________________________________________________________________________
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pca_ae_encoder</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">img</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span><span class="o">...</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-2.2966329e-04,  3.9284377e+00]], dtype=float32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">encoder_0</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">img</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span><span class="o">...</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[3.9284377]], dtype=float32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)):</span>
    <span class="n">img_dec</span> <span class="o">=</span> <span class="n">pca_ae_decoder</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">]])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_dec</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;z=(</span><span class="si">{</span><span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">, 0)&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:tensorflow:5 out of the last 40 calls to &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x7f4653a08440&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
</pre></div>
</div>
<img alt="../_images/pca_ae_hierarchy_32_1.png" src="../_images/pca_ae_hierarchy_32_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)):</span>
    <span class="n">img_dec</span> <span class="o">=</span> <span class="n">pca_ae_decoder</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">]]])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_dec</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;z=(0, </span><span class="si">{</span><span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/pca_ae_hierarchy_33_0.png" src="../_images/pca_ae_hierarchy_33_0.png" />
</div>
</div>
</div>
<div class="section" id="cnn-autoencoder">
<h2>CNN Autoencoder<a class="headerlink" href="#cnn-autoencoder" title="Permalink to this headline">¶</a></h2>
<p>For comparison, we will have a look at a conventional autoencoder without the custom layer to account for latent covariance. I will keep all the other layers the same (including the BatchNormalization to ensure similar values in the latent space).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">encoder</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">(),</span>
    <span class="c1">#keras.layers.BatchNormalization(),</span>
    <span class="n">LatentCovarianceLayer</span><span class="p">()</span>
<span class="p">])</span>

<span class="n">decoder</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2DTranspose</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2DTranspose</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>  <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2DTranspose</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2DTranspose</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">(),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2DTranspose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">),</span>
<span class="p">])</span>

<span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.002</span><span class="p">)</span>
<span class="n">pca_ae</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span><span class="n">encoder</span><span class="p">,</span> <span class="n">decoder</span><span class="p">])</span>
<span class="n">pca_ae</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>

<span class="n">tempfn</span><span class="o">=</span><span class="s1">&#39;./model_ae.hdf5&#39;</span>
<span class="n">model_cb</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ModelCheckpoint</span><span class="p">(</span><span class="n">tempfn</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span><span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">early_cb</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">learning_rate_reduction</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span>
                                                            <span class="n">patience</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
                                                            <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                                            <span class="n">factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                                            <span class="n">min_lr</span><span class="o">=</span><span class="mf">0.00001</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_cb</span><span class="p">,</span> <span class="n">early_cb</span><span class="p">,</span> <span class="n">learning_rate_reduction</span><span class="p">]</span>

<span class="n">history</span><span class="o">=</span><span class="n">pca_ae</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span>
                   <span class="n">epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                   <span class="n">batch_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
                   <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">callbacks</span><span class="o">=</span><span class="n">cb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/1000
16/16 [==============================] - 2s 59ms/step - loss: 0.1994

Epoch 00001: loss improved from inf to 0.19943, saving model to ./model_ae.hdf5
Epoch 2/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.1751

Epoch 00002: loss improved from 0.19943 to 0.17513, saving model to ./model_ae.hdf5
Epoch 3/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.1602

Epoch 00003: loss improved from 0.17513 to 0.16024, saving model to ./model_ae.hdf5
Epoch 4/1000
16/16 [==============================] - 1s 51ms/step - loss: 0.1321

Epoch 00004: loss improved from 0.16024 to 0.13208, saving model to ./model_ae.hdf5
Epoch 5/1000
16/16 [==============================] - 1s 51ms/step - loss: 0.0805

Epoch 00005: loss improved from 0.13208 to 0.08050, saving model to ./model_ae.hdf5
Epoch 6/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0617

Epoch 00006: loss improved from 0.08050 to 0.06172, saving model to ./model_ae.hdf5
Epoch 7/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0556

Epoch 00007: loss improved from 0.06172 to 0.05556, saving model to ./model_ae.hdf5
Epoch 8/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0520

Epoch 00008: loss improved from 0.05556 to 0.05200, saving model to ./model_ae.hdf5
Epoch 9/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0499

Epoch 00009: loss improved from 0.05200 to 0.04987, saving model to ./model_ae.hdf5
Epoch 10/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0479

Epoch 00010: loss improved from 0.04987 to 0.04786, saving model to ./model_ae.hdf5
Epoch 11/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0454

Epoch 00011: loss improved from 0.04786 to 0.04539, saving model to ./model_ae.hdf5
Epoch 12/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0432

Epoch 00012: loss improved from 0.04539 to 0.04316, saving model to ./model_ae.hdf5
Epoch 13/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0408

Epoch 00013: loss improved from 0.04316 to 0.04081, saving model to ./model_ae.hdf5
Epoch 14/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0383

Epoch 00014: loss improved from 0.04081 to 0.03831, saving model to ./model_ae.hdf5
Epoch 15/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0359

Epoch 00015: loss improved from 0.03831 to 0.03587, saving model to ./model_ae.hdf5
Epoch 16/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0337

Epoch 00016: loss improved from 0.03587 to 0.03369, saving model to ./model_ae.hdf5
Epoch 17/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0316

Epoch 00017: loss improved from 0.03369 to 0.03158, saving model to ./model_ae.hdf5
Epoch 18/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0303

Epoch 00018: loss improved from 0.03158 to 0.03029, saving model to ./model_ae.hdf5
Epoch 19/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0284

Epoch 00019: loss improved from 0.03029 to 0.02844, saving model to ./model_ae.hdf5
Epoch 20/1000
16/16 [==============================] - 1s 51ms/step - loss: 0.0276

Epoch 00020: loss improved from 0.02844 to 0.02760, saving model to ./model_ae.hdf5
Epoch 21/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0266

Epoch 00021: loss improved from 0.02760 to 0.02657, saving model to ./model_ae.hdf5
Epoch 22/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0254

Epoch 00022: loss improved from 0.02657 to 0.02542, saving model to ./model_ae.hdf5
Epoch 23/1000
16/16 [==============================] - 1s 51ms/step - loss: 0.0248

Epoch 00023: loss improved from 0.02542 to 0.02475, saving model to ./model_ae.hdf5
Epoch 24/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0244

Epoch 00024: loss improved from 0.02475 to 0.02440, saving model to ./model_ae.hdf5
Epoch 25/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0243

Epoch 00025: loss improved from 0.02440 to 0.02425, saving model to ./model_ae.hdf5
Epoch 26/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0229

Epoch 00026: loss improved from 0.02425 to 0.02291, saving model to ./model_ae.hdf5
Epoch 27/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0217

Epoch 00027: loss improved from 0.02291 to 0.02167, saving model to ./model_ae.hdf5
Epoch 28/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0210

Epoch 00028: loss improved from 0.02167 to 0.02099, saving model to ./model_ae.hdf5
Epoch 29/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0201

Epoch 00029: loss improved from 0.02099 to 0.02015, saving model to ./model_ae.hdf5
Epoch 30/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0196

Epoch 00030: loss improved from 0.02015 to 0.01963, saving model to ./model_ae.hdf5
Epoch 31/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0188

Epoch 00031: loss improved from 0.01963 to 0.01876, saving model to ./model_ae.hdf5
Epoch 32/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0181

Epoch 00032: loss improved from 0.01876 to 0.01813, saving model to ./model_ae.hdf5
Epoch 33/1000
16/16 [==============================] - 1s 51ms/step - loss: 0.0178

Epoch 00033: loss improved from 0.01813 to 0.01775, saving model to ./model_ae.hdf5
Epoch 34/1000
16/16 [==============================] - 1s 51ms/step - loss: 0.0182

Epoch 00034: loss did not improve from 0.01775
Epoch 35/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0174

Epoch 00035: loss improved from 0.01775 to 0.01737, saving model to ./model_ae.hdf5
Epoch 36/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0169

Epoch 00036: loss improved from 0.01737 to 0.01688, saving model to ./model_ae.hdf5
Epoch 37/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0164

Epoch 00037: loss improved from 0.01688 to 0.01639, saving model to ./model_ae.hdf5
Epoch 38/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0163

Epoch 00038: loss improved from 0.01639 to 0.01630, saving model to ./model_ae.hdf5
Epoch 39/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0159

Epoch 00039: loss improved from 0.01630 to 0.01593, saving model to ./model_ae.hdf5
Epoch 40/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0151

Epoch 00040: loss improved from 0.01593 to 0.01512, saving model to ./model_ae.hdf5
Epoch 41/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0148

Epoch 00041: loss improved from 0.01512 to 0.01476, saving model to ./model_ae.hdf5
Epoch 42/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0145

Epoch 00042: loss improved from 0.01476 to 0.01451, saving model to ./model_ae.hdf5
Epoch 43/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0142

Epoch 00043: loss improved from 0.01451 to 0.01421, saving model to ./model_ae.hdf5
Epoch 44/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0144

Epoch 00044: loss did not improve from 0.01421
Epoch 45/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0137

Epoch 00045: loss improved from 0.01421 to 0.01369, saving model to ./model_ae.hdf5
Epoch 46/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0136

Epoch 00046: loss improved from 0.01369 to 0.01356, saving model to ./model_ae.hdf5
Epoch 47/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0135

Epoch 00047: loss improved from 0.01356 to 0.01345, saving model to ./model_ae.hdf5
Epoch 48/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0133

Epoch 00048: loss improved from 0.01345 to 0.01327, saving model to ./model_ae.hdf5
Epoch 49/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0128

Epoch 00049: loss improved from 0.01327 to 0.01279, saving model to ./model_ae.hdf5
Epoch 50/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0125

Epoch 00050: loss improved from 0.01279 to 0.01245, saving model to ./model_ae.hdf5
Epoch 51/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0123

Epoch 00051: loss improved from 0.01245 to 0.01230, saving model to ./model_ae.hdf5
Epoch 52/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0121

Epoch 00052: loss improved from 0.01230 to 0.01209, saving model to ./model_ae.hdf5
Epoch 53/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0120

Epoch 00053: loss improved from 0.01209 to 0.01198, saving model to ./model_ae.hdf5
Epoch 54/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0118

Epoch 00054: loss improved from 0.01198 to 0.01179, saving model to ./model_ae.hdf5
Epoch 55/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0115

Epoch 00055: loss improved from 0.01179 to 0.01154, saving model to ./model_ae.hdf5
Epoch 56/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0115

Epoch 00056: loss improved from 0.01154 to 0.01149, saving model to ./model_ae.hdf5
Epoch 57/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0114

Epoch 00057: loss improved from 0.01149 to 0.01137, saving model to ./model_ae.hdf5
Epoch 58/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0112

Epoch 00058: loss improved from 0.01137 to 0.01123, saving model to ./model_ae.hdf5
Epoch 59/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0111

Epoch 00059: loss improved from 0.01123 to 0.01109, saving model to ./model_ae.hdf5
Epoch 60/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0111

Epoch 00060: loss improved from 0.01109 to 0.01105, saving model to ./model_ae.hdf5
Epoch 61/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0108

Epoch 00061: loss improved from 0.01105 to 0.01079, saving model to ./model_ae.hdf5
Epoch 62/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0105

Epoch 00062: loss improved from 0.01079 to 0.01050, saving model to ./model_ae.hdf5
Epoch 63/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0105

Epoch 00063: loss improved from 0.01050 to 0.01046, saving model to ./model_ae.hdf5
Epoch 64/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0109

Epoch 00064: loss did not improve from 0.01046
Epoch 65/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0107

Epoch 00065: loss did not improve from 0.01046
Epoch 66/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0105

Epoch 00066: loss did not improve from 0.01046
Epoch 67/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0101

Epoch 00067: loss improved from 0.01046 to 0.01011, saving model to ./model_ae.hdf5
Epoch 68/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0101

Epoch 00068: loss improved from 0.01011 to 0.01009, saving model to ./model_ae.hdf5
Epoch 69/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0102

Epoch 00069: loss did not improve from 0.01009
Epoch 70/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0100

Epoch 00070: loss improved from 0.01009 to 0.00996, saving model to ./model_ae.hdf5
Epoch 71/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0097

Epoch 00071: loss improved from 0.00996 to 0.00969, saving model to ./model_ae.hdf5
Epoch 72/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0097

Epoch 00072: loss did not improve from 0.00969
Epoch 73/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0097

Epoch 00073: loss did not improve from 0.00969
Epoch 74/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0096

Epoch 00074: loss improved from 0.00969 to 0.00960, saving model to ./model_ae.hdf5
Epoch 75/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0096

Epoch 00075: loss improved from 0.00960 to 0.00959, saving model to ./model_ae.hdf5
Epoch 76/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0097

Epoch 00076: loss did not improve from 0.00959
Epoch 77/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0097

Epoch 00077: loss did not improve from 0.00959
Epoch 78/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0093

Epoch 00078: loss improved from 0.00959 to 0.00934, saving model to ./model_ae.hdf5
Epoch 79/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0094

Epoch 00079: loss did not improve from 0.00934
Epoch 80/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0093

Epoch 00080: loss improved from 0.00934 to 0.00930, saving model to ./model_ae.hdf5
Epoch 81/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0091

Epoch 00081: loss improved from 0.00930 to 0.00907, saving model to ./model_ae.hdf5
Epoch 82/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0090

Epoch 00082: loss improved from 0.00907 to 0.00904, saving model to ./model_ae.hdf5
Epoch 83/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0091

Epoch 00083: loss did not improve from 0.00904
Epoch 84/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0092

Epoch 00084: loss did not improve from 0.00904
Epoch 85/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0095

Epoch 00085: loss did not improve from 0.00904
Epoch 86/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0091

Epoch 00086: loss did not improve from 0.00904
Epoch 87/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0090

Epoch 00087: loss improved from 0.00904 to 0.00899, saving model to ./model_ae.hdf5
Epoch 88/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0088

Epoch 00088: loss improved from 0.00899 to 0.00882, saving model to ./model_ae.hdf5
Epoch 89/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0087

Epoch 00089: loss improved from 0.00882 to 0.00874, saving model to ./model_ae.hdf5
Epoch 90/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0086

Epoch 00090: loss improved from 0.00874 to 0.00864, saving model to ./model_ae.hdf5
Epoch 91/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0089

Epoch 00091: loss did not improve from 0.00864
Epoch 92/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0087

Epoch 00092: loss did not improve from 0.00864
Epoch 93/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0086

Epoch 00093: loss improved from 0.00864 to 0.00858, saving model to ./model_ae.hdf5
Epoch 94/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0087

Epoch 00094: loss did not improve from 0.00858
Epoch 95/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0086

Epoch 00095: loss did not improve from 0.00858
Epoch 96/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0085

Epoch 00096: loss improved from 0.00858 to 0.00852, saving model to ./model_ae.hdf5
Epoch 97/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0086

Epoch 00097: loss did not improve from 0.00852
Epoch 98/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0085

Epoch 00098: loss improved from 0.00852 to 0.00848, saving model to ./model_ae.hdf5
Epoch 99/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0087

Epoch 00099: loss did not improve from 0.00848
Epoch 100/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0089

Epoch 00100: loss did not improve from 0.00848
Epoch 101/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0085

Epoch 00101: loss did not improve from 0.00848
Epoch 102/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0085

Epoch 00102: loss did not improve from 0.00848
Epoch 103/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0084

Epoch 00103: loss improved from 0.00848 to 0.00840, saving model to ./model_ae.hdf5
Epoch 104/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0083

Epoch 00104: loss improved from 0.00840 to 0.00830, saving model to ./model_ae.hdf5
Epoch 105/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0083

Epoch 00105: loss did not improve from 0.00830
Epoch 106/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0082

Epoch 00106: loss improved from 0.00830 to 0.00821, saving model to ./model_ae.hdf5
Epoch 107/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0084

Epoch 00107: loss did not improve from 0.00821
Epoch 108/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0081

Epoch 00108: loss improved from 0.00821 to 0.00815, saving model to ./model_ae.hdf5
Epoch 109/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0081

Epoch 00109: loss improved from 0.00815 to 0.00806, saving model to ./model_ae.hdf5
Epoch 110/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0081

Epoch 00110: loss did not improve from 0.00806
Epoch 111/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0081

Epoch 00111: loss did not improve from 0.00806
Epoch 112/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0082

Epoch 00112: loss did not improve from 0.00806
Epoch 113/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0082

Epoch 00113: loss did not improve from 0.00806
Epoch 114/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0081

Epoch 00114: loss improved from 0.00806 to 0.00806, saving model to ./model_ae.hdf5
Epoch 115/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0082

Epoch 00115: loss did not improve from 0.00806
Epoch 116/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0082

Epoch 00116: loss did not improve from 0.00806
Epoch 117/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0080

Epoch 00117: loss improved from 0.00806 to 0.00796, saving model to ./model_ae.hdf5
Epoch 118/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0080

Epoch 00118: loss improved from 0.00796 to 0.00795, saving model to ./model_ae.hdf5
Epoch 119/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0081

Epoch 00119: loss did not improve from 0.00795
Epoch 120/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0080

Epoch 00120: loss did not improve from 0.00795
Epoch 121/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0081

Epoch 00121: loss did not improve from 0.00795
Epoch 122/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0080

Epoch 00122: loss did not improve from 0.00795
Epoch 123/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0079

Epoch 00123: loss improved from 0.00795 to 0.00794, saving model to ./model_ae.hdf5
Epoch 124/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0080

Epoch 00124: loss did not improve from 0.00794
Epoch 125/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0082

Epoch 00125: loss did not improve from 0.00794
Epoch 126/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0078

Epoch 00126: loss improved from 0.00794 to 0.00783, saving model to ./model_ae.hdf5
Epoch 127/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0078

Epoch 00127: loss improved from 0.00783 to 0.00776, saving model to ./model_ae.hdf5
Epoch 128/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0077

Epoch 00128: loss improved from 0.00776 to 0.00769, saving model to ./model_ae.hdf5
Epoch 129/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0078

Epoch 00129: loss did not improve from 0.00769
Epoch 130/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0077

Epoch 00130: loss did not improve from 0.00769
Epoch 131/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0078

Epoch 00131: loss did not improve from 0.00769
Epoch 132/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0078

Epoch 00132: loss did not improve from 0.00769
Epoch 133/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0078

Epoch 00133: loss did not improve from 0.00769
Epoch 134/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0078

Epoch 00134: loss did not improve from 0.00769
Epoch 135/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0078

Epoch 00135: loss did not improve from 0.00769
Epoch 136/1000
16/16 [==============================] - 1s 51ms/step - loss: 0.0078

Epoch 00136: loss did not improve from 0.00769
Epoch 137/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0079

Epoch 00137: loss did not improve from 0.00769
Epoch 138/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0078

Epoch 00138: loss did not improve from 0.00769
Epoch 139/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0077

Epoch 00139: loss did not improve from 0.00769
Epoch 140/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0077

Epoch 00140: loss did not improve from 0.00769
Epoch 141/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0077

Epoch 00141: loss improved from 0.00769 to 0.00768, saving model to ./model_ae.hdf5
Epoch 142/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0077

Epoch 00142: loss did not improve from 0.00768
Epoch 143/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0078

Epoch 00143: loss did not improve from 0.00768
Epoch 144/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0077

Epoch 00144: loss did not improve from 0.00768
Epoch 145/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0076

Epoch 00145: loss improved from 0.00768 to 0.00759, saving model to ./model_ae.hdf5
Epoch 146/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0075

Epoch 00146: loss improved from 0.00759 to 0.00754, saving model to ./model_ae.hdf5
Epoch 147/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0076

Epoch 00147: loss did not improve from 0.00754
Epoch 148/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0076

Epoch 00148: loss did not improve from 0.00754
Epoch 149/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0075

Epoch 00149: loss improved from 0.00754 to 0.00754, saving model to ./model_ae.hdf5
Epoch 150/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0075

Epoch 00150: loss improved from 0.00754 to 0.00753, saving model to ./model_ae.hdf5
Epoch 151/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0075

Epoch 00151: loss improved from 0.00753 to 0.00751, saving model to ./model_ae.hdf5
Epoch 152/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0076

Epoch 00152: loss did not improve from 0.00751
Epoch 153/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0076

Epoch 00153: loss did not improve from 0.00751
Epoch 154/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0074

Epoch 00154: loss improved from 0.00751 to 0.00742, saving model to ./model_ae.hdf5
Epoch 155/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0075

Epoch 00155: loss did not improve from 0.00742
Epoch 156/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0075

Epoch 00156: loss did not improve from 0.00742
Epoch 157/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0074

Epoch 00157: loss improved from 0.00742 to 0.00738, saving model to ./model_ae.hdf5
Epoch 158/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0074

Epoch 00158: loss improved from 0.00738 to 0.00737, saving model to ./model_ae.hdf5
Epoch 159/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0075

Epoch 00159: loss did not improve from 0.00737
Epoch 160/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0074

Epoch 00160: loss did not improve from 0.00737
Epoch 161/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0075

Epoch 00161: loss did not improve from 0.00737
Epoch 162/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0073

Epoch 00162: loss improved from 0.00737 to 0.00733, saving model to ./model_ae.hdf5
Epoch 163/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0073

Epoch 00163: loss did not improve from 0.00733
Epoch 164/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0074

Epoch 00164: loss did not improve from 0.00733
Epoch 165/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0073

Epoch 00165: loss improved from 0.00733 to 0.00729, saving model to ./model_ae.hdf5
Epoch 166/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0074

Epoch 00166: loss did not improve from 0.00729
Epoch 167/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0076

Epoch 00167: loss did not improve from 0.00729
Epoch 168/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0075

Epoch 00168: loss did not improve from 0.00729
Epoch 169/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0075

Epoch 00169: loss did not improve from 0.00729
Epoch 170/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0073

Epoch 00170: loss did not improve from 0.00729
Epoch 171/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0073

Epoch 00171: loss improved from 0.00729 to 0.00728, saving model to ./model_ae.hdf5
Epoch 172/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0072

Epoch 00172: loss improved from 0.00728 to 0.00724, saving model to ./model_ae.hdf5
Epoch 173/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0073

Epoch 00173: loss did not improve from 0.00724
Epoch 174/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0076

Epoch 00174: loss did not improve from 0.00724
Epoch 175/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0073

Epoch 00175: loss did not improve from 0.00724
Epoch 176/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0072

Epoch 00176: loss improved from 0.00724 to 0.00719, saving model to ./model_ae.hdf5
Epoch 177/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0073

Epoch 00177: loss did not improve from 0.00719
Epoch 178/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0072

Epoch 00178: loss did not improve from 0.00719
Epoch 179/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0072

Epoch 00179: loss improved from 0.00719 to 0.00715, saving model to ./model_ae.hdf5
Epoch 180/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0072

Epoch 00180: loss did not improve from 0.00715
Epoch 181/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0073

Epoch 00181: loss did not improve from 0.00715
Epoch 182/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0071

Epoch 00182: loss improved from 0.00715 to 0.00711, saving model to ./model_ae.hdf5
Epoch 183/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0072

Epoch 00183: loss did not improve from 0.00711
Epoch 184/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0071

Epoch 00184: loss did not improve from 0.00711
Epoch 185/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0072

Epoch 00185: loss did not improve from 0.00711
Epoch 186/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0071

Epoch 00186: loss did not improve from 0.00711
Epoch 187/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0073

Epoch 00187: loss did not improve from 0.00711
Epoch 188/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0072

Epoch 00188: loss did not improve from 0.00711
Epoch 189/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0072

Epoch 00189: loss did not improve from 0.00711
Epoch 190/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0071

Epoch 00190: loss improved from 0.00711 to 0.00706, saving model to ./model_ae.hdf5
Epoch 191/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0070

Epoch 00191: loss improved from 0.00706 to 0.00703, saving model to ./model_ae.hdf5
Epoch 192/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0070

Epoch 00192: loss improved from 0.00703 to 0.00702, saving model to ./model_ae.hdf5
Epoch 193/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0072

Epoch 00193: loss did not improve from 0.00702
Epoch 194/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0076

Epoch 00194: loss did not improve from 0.00702
Epoch 195/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0071

Epoch 00195: loss did not improve from 0.00702
Epoch 196/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0070

Epoch 00196: loss improved from 0.00702 to 0.00695, saving model to ./model_ae.hdf5
Epoch 197/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0069

Epoch 00197: loss improved from 0.00695 to 0.00692, saving model to ./model_ae.hdf5
Epoch 198/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0070

Epoch 00198: loss did not improve from 0.00692
Epoch 199/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0070

Epoch 00199: loss did not improve from 0.00692
Epoch 200/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0070

Epoch 00200: loss did not improve from 0.00692
Epoch 201/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0070

Epoch 00201: loss did not improve from 0.00692
Epoch 202/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0069

Epoch 00202: loss did not improve from 0.00692
Epoch 203/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0069

Epoch 00203: loss improved from 0.00692 to 0.00692, saving model to ./model_ae.hdf5
Epoch 204/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0068

Epoch 00204: loss improved from 0.00692 to 0.00685, saving model to ./model_ae.hdf5
Epoch 205/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0069

Epoch 00205: loss did not improve from 0.00685
Epoch 206/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0070

Epoch 00206: loss did not improve from 0.00685
Epoch 207/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0069

Epoch 00207: loss did not improve from 0.00685
Epoch 208/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0069

Epoch 00208: loss did not improve from 0.00685
Epoch 209/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0069

Epoch 00209: loss did not improve from 0.00685
Epoch 210/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0068

Epoch 00210: loss improved from 0.00685 to 0.00680, saving model to ./model_ae.hdf5
Epoch 211/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0069

Epoch 00211: loss did not improve from 0.00680
Epoch 212/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0069

Epoch 00212: loss did not improve from 0.00680
Epoch 213/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0069

Epoch 00213: loss did not improve from 0.00680
Epoch 214/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0068

Epoch 00214: loss did not improve from 0.00680
Epoch 215/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0069

Epoch 00215: loss did not improve from 0.00680
Epoch 216/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0069

Epoch 00216: loss did not improve from 0.00680
Epoch 217/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0068

Epoch 00217: loss did not improve from 0.00680
Epoch 218/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0071

Epoch 00218: loss did not improve from 0.00680
Epoch 219/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0069

Epoch 00219: loss did not improve from 0.00680
Epoch 220/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0068

Epoch 00220: loss did not improve from 0.00680
Epoch 221/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0069

Epoch 00221: loss did not improve from 0.00680
Epoch 222/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0069

Epoch 00222: loss did not improve from 0.00680
Epoch 223/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0067

Epoch 00223: loss improved from 0.00680 to 0.00673, saving model to ./model_ae.hdf5
Epoch 224/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0070

Epoch 00224: loss did not improve from 0.00673
Epoch 225/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0071

Epoch 00225: loss did not improve from 0.00673
Epoch 226/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0068

Epoch 00226: loss did not improve from 0.00673
Epoch 227/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0067

Epoch 00227: loss improved from 0.00673 to 0.00669, saving model to ./model_ae.hdf5
Epoch 228/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0067

Epoch 00228: loss improved from 0.00669 to 0.00667, saving model to ./model_ae.hdf5
Epoch 229/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0067

Epoch 00229: loss did not improve from 0.00667
Epoch 230/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0067

Epoch 00230: loss did not improve from 0.00667
Epoch 231/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0068

Epoch 00231: loss did not improve from 0.00667
Epoch 232/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0067

Epoch 00232: loss did not improve from 0.00667
Epoch 233/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0068

Epoch 00233: loss did not improve from 0.00667
Epoch 234/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0070

Epoch 00234: loss did not improve from 0.00667
Epoch 235/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0068

Epoch 00235: loss did not improve from 0.00667
Epoch 236/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0066

Epoch 00236: loss improved from 0.00667 to 0.00664, saving model to ./model_ae.hdf5
Epoch 237/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0066

Epoch 00237: loss did not improve from 0.00664
Epoch 238/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0069

Epoch 00238: loss did not improve from 0.00664
Epoch 239/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0067

Epoch 00239: loss did not improve from 0.00664
Epoch 240/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0066

Epoch 00240: loss improved from 0.00664 to 0.00659, saving model to ./model_ae.hdf5
Epoch 241/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0066

Epoch 00241: loss did not improve from 0.00659
Epoch 242/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0066

Epoch 00242: loss did not improve from 0.00659
Epoch 243/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0066

Epoch 00243: loss improved from 0.00659 to 0.00658, saving model to ./model_ae.hdf5
Epoch 244/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0066

Epoch 00244: loss improved from 0.00658 to 0.00657, saving model to ./model_ae.hdf5
Epoch 245/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0067

Epoch 00245: loss did not improve from 0.00657
Epoch 246/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0065

Epoch 00246: loss improved from 0.00657 to 0.00649, saving model to ./model_ae.hdf5
Epoch 247/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0066

Epoch 00247: loss did not improve from 0.00649
Epoch 248/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0067

Epoch 00248: loss did not improve from 0.00649
Epoch 249/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0066

Epoch 00249: loss did not improve from 0.00649
Epoch 250/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0065

Epoch 00250: loss did not improve from 0.00649
Epoch 251/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0068

Epoch 00251: loss did not improve from 0.00649
Epoch 252/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0069

Epoch 00252: loss did not improve from 0.00649
Epoch 253/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0068

Epoch 00253: loss did not improve from 0.00649
Epoch 254/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0065

Epoch 00254: loss did not improve from 0.00649
Epoch 255/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0064

Epoch 00255: loss improved from 0.00649 to 0.00643, saving model to ./model_ae.hdf5
Epoch 256/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0065

Epoch 00256: loss did not improve from 0.00643
Epoch 257/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0065

Epoch 00257: loss did not improve from 0.00643
Epoch 258/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0067

Epoch 00258: loss did not improve from 0.00643
Epoch 259/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0066

Epoch 00259: loss did not improve from 0.00643
Epoch 260/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0067

Epoch 00260: loss did not improve from 0.00643
Epoch 261/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0066

Epoch 00261: loss did not improve from 0.00643
Epoch 262/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0065

Epoch 00262: loss did not improve from 0.00643
Epoch 263/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0065

Epoch 00263: loss did not improve from 0.00643
Epoch 264/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0064

Epoch 00264: loss did not improve from 0.00643
Epoch 265/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0064

Epoch 00265: loss improved from 0.00643 to 0.00642, saving model to ./model_ae.hdf5
Epoch 266/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0064

Epoch 00266: loss improved from 0.00642 to 0.00640, saving model to ./model_ae.hdf5
Epoch 267/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0064

Epoch 00267: loss did not improve from 0.00640
Epoch 268/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0064

Epoch 00268: loss improved from 0.00640 to 0.00639, saving model to ./model_ae.hdf5
Epoch 269/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0065

Epoch 00269: loss did not improve from 0.00639
Epoch 270/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0064

Epoch 00270: loss improved from 0.00639 to 0.00635, saving model to ./model_ae.hdf5
Epoch 271/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0063

Epoch 00271: loss improved from 0.00635 to 0.00632, saving model to ./model_ae.hdf5
Epoch 272/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0063

Epoch 00272: loss did not improve from 0.00632
Epoch 273/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0064

Epoch 00273: loss did not improve from 0.00632
Epoch 274/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0064

Epoch 00274: loss did not improve from 0.00632
Epoch 275/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0064

Epoch 00275: loss did not improve from 0.00632
Epoch 276/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0064

Epoch 00276: loss did not improve from 0.00632
Epoch 277/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0067

Epoch 00277: loss did not improve from 0.00632
Epoch 278/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0064

Epoch 00278: loss did not improve from 0.00632
Epoch 279/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0064

Epoch 00279: loss did not improve from 0.00632
Epoch 280/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0064

Epoch 00280: loss did not improve from 0.00632
Epoch 281/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0063

Epoch 00281: loss improved from 0.00632 to 0.00631, saving model to ./model_ae.hdf5
Epoch 282/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0063

Epoch 00282: loss improved from 0.00631 to 0.00625, saving model to ./model_ae.hdf5
Epoch 283/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0063

Epoch 00283: loss did not improve from 0.00625
Epoch 284/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0063

Epoch 00284: loss did not improve from 0.00625
Epoch 285/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0063

Epoch 00285: loss did not improve from 0.00625
Epoch 286/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0063

Epoch 00286: loss did not improve from 0.00625
Epoch 287/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0063

Epoch 00287: loss did not improve from 0.00625
Epoch 288/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0065

Epoch 00288: loss did not improve from 0.00625
Epoch 289/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0065

Epoch 00289: loss did not improve from 0.00625
Epoch 290/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0063

Epoch 00290: loss did not improve from 0.00625
Epoch 291/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0064

Epoch 00291: loss did not improve from 0.00625
Epoch 292/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0063

Epoch 00292: loss did not improve from 0.00625
Epoch 293/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0063

Epoch 00293: loss did not improve from 0.00625
Epoch 294/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0062

Epoch 00294: loss improved from 0.00625 to 0.00622, saving model to ./model_ae.hdf5
Epoch 295/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0064

Epoch 00295: loss did not improve from 0.00622
Epoch 296/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0067

Epoch 00296: loss did not improve from 0.00622
Epoch 297/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0064

Epoch 00297: loss did not improve from 0.00622
Epoch 298/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0062

Epoch 00298: loss did not improve from 0.00622
Epoch 299/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0063

Epoch 00299: loss did not improve from 0.00622
Epoch 300/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0064

Epoch 00300: loss did not improve from 0.00622
Epoch 301/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0062

Epoch 00301: loss did not improve from 0.00622
Epoch 302/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0062

Epoch 00302: loss improved from 0.00622 to 0.00621, saving model to ./model_ae.hdf5
Epoch 303/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0062

Epoch 00303: loss did not improve from 0.00621
Epoch 304/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0061

Epoch 00304: loss improved from 0.00621 to 0.00613, saving model to ./model_ae.hdf5
Epoch 305/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0062

Epoch 00305: loss did not improve from 0.00613
Epoch 306/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0061

Epoch 00306: loss improved from 0.00613 to 0.00613, saving model to ./model_ae.hdf5
Epoch 307/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0061

Epoch 00307: loss did not improve from 0.00613
Epoch 308/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0062

Epoch 00308: loss did not improve from 0.00613
Epoch 309/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0062

Epoch 00309: loss did not improve from 0.00613
Epoch 310/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0061

Epoch 00310: loss improved from 0.00613 to 0.00609, saving model to ./model_ae.hdf5
Epoch 311/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0061

Epoch 00311: loss did not improve from 0.00609
Epoch 312/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0061

Epoch 00312: loss did not improve from 0.00609
Epoch 313/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0061

Epoch 00313: loss improved from 0.00609 to 0.00608, saving model to ./model_ae.hdf5
Epoch 314/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0061

Epoch 00314: loss did not improve from 0.00608
Epoch 315/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0061

Epoch 00315: loss improved from 0.00608 to 0.00607, saving model to ./model_ae.hdf5
Epoch 316/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0061

Epoch 00316: loss did not improve from 0.00607
Epoch 317/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0063

Epoch 00317: loss did not improve from 0.00607
Epoch 318/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0062

Epoch 00318: loss did not improve from 0.00607
Epoch 319/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0060

Epoch 00319: loss improved from 0.00607 to 0.00604, saving model to ./model_ae.hdf5
Epoch 320/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0061

Epoch 00320: loss did not improve from 0.00604
Epoch 321/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0061

Epoch 00321: loss did not improve from 0.00604
Epoch 322/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0061

Epoch 00322: loss did not improve from 0.00604
Epoch 323/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0060

Epoch 00323: loss improved from 0.00604 to 0.00598, saving model to ./model_ae.hdf5
Epoch 324/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0060

Epoch 00324: loss did not improve from 0.00598
Epoch 325/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0062

Epoch 00325: loss did not improve from 0.00598
Epoch 326/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0066

Epoch 00326: loss did not improve from 0.00598
Epoch 327/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0064

Epoch 00327: loss did not improve from 0.00598
Epoch 328/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0061

Epoch 00328: loss did not improve from 0.00598
Epoch 329/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0060

Epoch 00329: loss did not improve from 0.00598
Epoch 330/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0061

Epoch 00330: loss did not improve from 0.00598
Epoch 331/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0060

Epoch 00331: loss did not improve from 0.00598
Epoch 332/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0060

Epoch 00332: loss did not improve from 0.00598
Epoch 333/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0060

Epoch 00333: loss improved from 0.00598 to 0.00597, saving model to ./model_ae.hdf5
Epoch 334/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0060

Epoch 00334: loss did not improve from 0.00597
Epoch 335/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0060

Epoch 00335: loss did not improve from 0.00597
Epoch 336/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0059

Epoch 00336: loss improved from 0.00597 to 0.00594, saving model to ./model_ae.hdf5
Epoch 337/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0060

Epoch 00337: loss did not improve from 0.00594
Epoch 338/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0061

Epoch 00338: loss did not improve from 0.00594
Epoch 339/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0060

Epoch 00339: loss did not improve from 0.00594
Epoch 340/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0060

Epoch 00340: loss did not improve from 0.00594
Epoch 341/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0059

Epoch 00341: loss improved from 0.00594 to 0.00593, saving model to ./model_ae.hdf5
Epoch 342/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0061

Epoch 00342: loss did not improve from 0.00593
Epoch 343/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0061

Epoch 00343: loss did not improve from 0.00593
Epoch 344/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0061

Epoch 00344: loss did not improve from 0.00593
Epoch 345/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0060

Epoch 00345: loss did not improve from 0.00593
Epoch 346/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0059

Epoch 00346: loss improved from 0.00593 to 0.00587, saving model to ./model_ae.hdf5
Epoch 347/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0059

Epoch 00347: loss did not improve from 0.00587
Epoch 348/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0061

Epoch 00348: loss did not improve from 0.00587
Epoch 349/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0062

Epoch 00349: loss did not improve from 0.00587
Epoch 350/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0060

Epoch 00350: loss did not improve from 0.00587
Epoch 351/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0059

Epoch 00351: loss did not improve from 0.00587
Epoch 352/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0058

Epoch 00352: loss improved from 0.00587 to 0.00583, saving model to ./model_ae.hdf5
Epoch 353/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0059

Epoch 00353: loss did not improve from 0.00583
Epoch 354/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0059

Epoch 00354: loss did not improve from 0.00583
Epoch 355/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0059

Epoch 00355: loss did not improve from 0.00583
Epoch 356/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0061

Epoch 00356: loss did not improve from 0.00583
Epoch 357/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0059

Epoch 00357: loss did not improve from 0.00583
Epoch 358/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0058

Epoch 00358: loss improved from 0.00583 to 0.00580, saving model to ./model_ae.hdf5
Epoch 359/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0059

Epoch 00359: loss did not improve from 0.00580
Epoch 360/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0058

Epoch 00360: loss did not improve from 0.00580
Epoch 361/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0059

Epoch 00361: loss did not improve from 0.00580
Epoch 362/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0059

Epoch 00362: loss did not improve from 0.00580
Epoch 363/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0058

Epoch 00363: loss improved from 0.00580 to 0.00578, saving model to ./model_ae.hdf5
Epoch 364/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0059

Epoch 00364: loss did not improve from 0.00578
Epoch 365/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0060

Epoch 00365: loss did not improve from 0.00578
Epoch 366/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0058

Epoch 00366: loss improved from 0.00578 to 0.00578, saving model to ./model_ae.hdf5
Epoch 367/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0058

Epoch 00367: loss did not improve from 0.00578
Epoch 368/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0058

Epoch 00368: loss did not improve from 0.00578
Epoch 369/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0057

Epoch 00369: loss improved from 0.00578 to 0.00572, saving model to ./model_ae.hdf5
Epoch 370/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0057

Epoch 00370: loss did not improve from 0.00572
Epoch 371/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0058

Epoch 00371: loss did not improve from 0.00572
Epoch 372/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0059

Epoch 00372: loss did not improve from 0.00572
Epoch 373/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0060

Epoch 00373: loss did not improve from 0.00572
Epoch 374/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0059

Epoch 00374: loss did not improve from 0.00572
Epoch 375/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0057

Epoch 00375: loss improved from 0.00572 to 0.00572, saving model to ./model_ae.hdf5
Epoch 376/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0058

Epoch 00376: loss did not improve from 0.00572
Epoch 377/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0058

Epoch 00377: loss did not improve from 0.00572
Epoch 378/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0059

Epoch 00378: loss did not improve from 0.00572
Epoch 379/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0059

Epoch 00379: loss did not improve from 0.00572
Epoch 380/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0058

Epoch 00380: loss did not improve from 0.00572
Epoch 381/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0057

Epoch 00381: loss did not improve from 0.00572
Epoch 382/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0057

Epoch 00382: loss did not improve from 0.00572
Epoch 383/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0058

Epoch 00383: loss did not improve from 0.00572
Epoch 384/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0058

Epoch 00384: loss did not improve from 0.00572
Epoch 385/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0057

Epoch 00385: loss did not improve from 0.00572
Epoch 386/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0057

Epoch 00386: loss improved from 0.00572 to 0.00569, saving model to ./model_ae.hdf5
Epoch 387/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0058

Epoch 00387: loss did not improve from 0.00569
Epoch 388/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0057

Epoch 00388: loss did not improve from 0.00569
Epoch 389/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0058

Epoch 00389: loss did not improve from 0.00569
Epoch 390/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0059

Epoch 00390: loss did not improve from 0.00569
Epoch 391/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0058

Epoch 00391: loss did not improve from 0.00569
Epoch 392/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0057

Epoch 00392: loss did not improve from 0.00569
Epoch 393/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0057

Epoch 00393: loss did not improve from 0.00569
Epoch 394/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0057

Epoch 00394: loss did not improve from 0.00569

Epoch 00394: ReduceLROnPlateau reducing learning rate to 0.0010000000474974513.
Epoch 395/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0057

Epoch 00395: loss improved from 0.00569 to 0.00568, saving model to ./model_ae.hdf5
Epoch 396/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0055

Epoch 00396: loss improved from 0.00568 to 0.00555, saving model to ./model_ae.hdf5
Epoch 397/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0055

Epoch 00397: loss improved from 0.00555 to 0.00554, saving model to ./model_ae.hdf5
Epoch 398/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0055

Epoch 00398: loss did not improve from 0.00554
Epoch 399/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0055

Epoch 00399: loss did not improve from 0.00554
Epoch 400/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0055

Epoch 00400: loss improved from 0.00554 to 0.00553, saving model to ./model_ae.hdf5
Epoch 401/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0055

Epoch 00401: loss improved from 0.00553 to 0.00553, saving model to ./model_ae.hdf5
Epoch 402/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0055

Epoch 00402: loss improved from 0.00553 to 0.00552, saving model to ./model_ae.hdf5
Epoch 403/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0055

Epoch 00403: loss improved from 0.00552 to 0.00552, saving model to ./model_ae.hdf5
Epoch 404/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0055

Epoch 00404: loss did not improve from 0.00552
Epoch 405/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0055

Epoch 00405: loss improved from 0.00552 to 0.00550, saving model to ./model_ae.hdf5
Epoch 406/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0055

Epoch 00406: loss did not improve from 0.00550
Epoch 407/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0055

Epoch 00407: loss did not improve from 0.00550
Epoch 408/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0055

Epoch 00408: loss did not improve from 0.00550
Epoch 409/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0055

Epoch 00409: loss did not improve from 0.00550
Epoch 410/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0055

Epoch 00410: loss did not improve from 0.00550
Epoch 411/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0055

Epoch 00411: loss did not improve from 0.00550
Epoch 412/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0055

Epoch 00412: loss did not improve from 0.00550
Epoch 413/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0055

Epoch 00413: loss did not improve from 0.00550
Epoch 414/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0055

Epoch 00414: loss improved from 0.00550 to 0.00549, saving model to ./model_ae.hdf5
Epoch 415/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0055

Epoch 00415: loss did not improve from 0.00549
Epoch 416/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0055

Epoch 00416: loss did not improve from 0.00549
Epoch 417/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0055

Epoch 00417: loss did not improve from 0.00549
Epoch 418/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0055

Epoch 00418: loss did not improve from 0.00549
Epoch 419/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0055

Epoch 00419: loss improved from 0.00549 to 0.00548, saving model to ./model_ae.hdf5
Epoch 420/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0055

Epoch 00420: loss did not improve from 0.00548
Epoch 421/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0055

Epoch 00421: loss did not improve from 0.00548

Epoch 00421: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.
Epoch 422/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0055

Epoch 00422: loss did not improve from 0.00548
Epoch 423/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0055

Epoch 00423: loss improved from 0.00548 to 0.00546, saving model to ./model_ae.hdf5
Epoch 424/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0055

Epoch 00424: loss improved from 0.00546 to 0.00546, saving model to ./model_ae.hdf5
Epoch 425/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0055

Epoch 00425: loss did not improve from 0.00546
Epoch 426/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0055

Epoch 00426: loss did not improve from 0.00546
Epoch 427/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0055

Epoch 00427: loss did not improve from 0.00546
Epoch 428/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0055

Epoch 00428: loss did not improve from 0.00546
Epoch 429/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00429: loss improved from 0.00546 to 0.00545, saving model to ./model_ae.hdf5
Epoch 430/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0055

Epoch 00430: loss did not improve from 0.00545
Epoch 431/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0055

Epoch 00431: loss did not improve from 0.00545
Epoch 432/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0055

Epoch 00432: loss did not improve from 0.00545
Epoch 433/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00433: loss improved from 0.00545 to 0.00545, saving model to ./model_ae.hdf5
Epoch 434/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00434: loss did not improve from 0.00545
Epoch 435/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0054

Epoch 00435: loss improved from 0.00545 to 0.00543, saving model to ./model_ae.hdf5
Epoch 436/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0055

Epoch 00436: loss did not improve from 0.00543
Epoch 437/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00437: loss did not improve from 0.00543
Epoch 438/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0055

Epoch 00438: loss did not improve from 0.00543
Epoch 439/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00439: loss did not improve from 0.00543
Epoch 440/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00440: loss improved from 0.00543 to 0.00543, saving model to ./model_ae.hdf5
Epoch 441/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00441: loss did not improve from 0.00543
Epoch 442/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00442: loss improved from 0.00543 to 0.00543, saving model to ./model_ae.hdf5
Epoch 443/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0055

Epoch 00443: loss did not improve from 0.00543
Epoch 444/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00444: loss improved from 0.00543 to 0.00542, saving model to ./model_ae.hdf5
Epoch 445/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00445: loss improved from 0.00542 to 0.00541, saving model to ./model_ae.hdf5
Epoch 446/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0055

Epoch 00446: loss did not improve from 0.00541
Epoch 447/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00447: loss did not improve from 0.00541
Epoch 448/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0054

Epoch 00448: loss did not improve from 0.00541
Epoch 449/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00449: loss did not improve from 0.00541
Epoch 450/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0054

Epoch 00450: loss did not improve from 0.00541
Epoch 451/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00451: loss did not improve from 0.00541
Epoch 452/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00452: loss did not improve from 0.00541
Epoch 453/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00453: loss did not improve from 0.00541
Epoch 454/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00454: loss did not improve from 0.00541
Epoch 455/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0054

Epoch 00455: loss improved from 0.00541 to 0.00541, saving model to ./model_ae.hdf5
Epoch 456/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00456: loss did not improve from 0.00541
Epoch 457/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00457: loss did not improve from 0.00541
Epoch 458/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00458: loss improved from 0.00541 to 0.00539, saving model to ./model_ae.hdf5

Epoch 00458: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.
Epoch 459/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00459: loss did not improve from 0.00539
Epoch 460/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00460: loss improved from 0.00539 to 0.00539, saving model to ./model_ae.hdf5
Epoch 461/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00461: loss improved from 0.00539 to 0.00539, saving model to ./model_ae.hdf5
Epoch 462/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0054

Epoch 00462: loss did not improve from 0.00539
Epoch 463/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0054

Epoch 00463: loss improved from 0.00539 to 0.00538, saving model to ./model_ae.hdf5
Epoch 464/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00464: loss did not improve from 0.00538
Epoch 465/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00465: loss did not improve from 0.00538
Epoch 466/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0054

Epoch 00466: loss did not improve from 0.00538
Epoch 467/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00467: loss did not improve from 0.00538
Epoch 468/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00468: loss did not improve from 0.00538
Epoch 469/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00469: loss did not improve from 0.00538
Epoch 470/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0054

Epoch 00470: loss did not improve from 0.00538
Epoch 471/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0054

Epoch 00471: loss improved from 0.00538 to 0.00538, saving model to ./model_ae.hdf5
Epoch 472/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00472: loss did not improve from 0.00538
Epoch 473/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00473: loss did not improve from 0.00538
Epoch 474/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00474: loss did not improve from 0.00538
Epoch 475/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00475: loss did not improve from 0.00538
Epoch 476/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00476: loss did not improve from 0.00538
Epoch 477/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00477: loss did not improve from 0.00538
Epoch 478/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00478: loss improved from 0.00538 to 0.00537, saving model to ./model_ae.hdf5
Epoch 479/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00479: loss did not improve from 0.00537
Epoch 480/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0054

Epoch 00480: loss did not improve from 0.00537
Epoch 481/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0054

Epoch 00481: loss did not improve from 0.00537
Epoch 482/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00482: loss did not improve from 0.00537
Epoch 483/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00483: loss did not improve from 0.00537

Epoch 00483: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.
Epoch 484/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00484: loss improved from 0.00537 to 0.00536, saving model to ./model_ae.hdf5
Epoch 485/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0053

Epoch 00485: loss improved from 0.00536 to 0.00535, saving model to ./model_ae.hdf5
Epoch 486/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00486: loss did not improve from 0.00535
Epoch 487/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00487: loss did not improve from 0.00535
Epoch 488/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00488: loss did not improve from 0.00535
Epoch 489/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00489: loss did not improve from 0.00535
Epoch 490/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00490: loss did not improve from 0.00535
Epoch 491/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00491: loss did not improve from 0.00535
Epoch 492/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00492: loss did not improve from 0.00535
Epoch 493/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00493: loss did not improve from 0.00535
Epoch 494/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00494: loss did not improve from 0.00535
Epoch 495/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00495: loss did not improve from 0.00535
Epoch 496/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0054

Epoch 00496: loss did not improve from 0.00535
Epoch 497/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00497: loss did not improve from 0.00535
Epoch 498/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00498: loss did not improve from 0.00535
Epoch 499/1000
16/16 [==============================] - 1s 59ms/step - loss: 0.0054

Epoch 00499: loss did not improve from 0.00535
Epoch 500/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00500: loss did not improve from 0.00535
Epoch 501/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00501: loss did not improve from 0.00535
Epoch 502/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00502: loss did not improve from 0.00535
Epoch 503/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0053

Epoch 00503: loss did not improve from 0.00535
Epoch 504/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00504: loss did not improve from 0.00535
Epoch 505/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00505: loss did not improve from 0.00535
Epoch 506/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00506: loss did not improve from 0.00535
Epoch 507/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0054

Epoch 00507: loss did not improve from 0.00535
Epoch 508/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0054

Epoch 00508: loss did not improve from 0.00535
Epoch 509/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0054

Epoch 00509: loss did not improve from 0.00535
Epoch 510/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00510: loss did not improve from 0.00535

Epoch 00510: ReduceLROnPlateau reducing learning rate to 6.25000029685907e-05.
Epoch 511/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00511: loss did not improve from 0.00535
Epoch 512/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00512: loss did not improve from 0.00535
Epoch 513/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0054

Epoch 00513: loss did not improve from 0.00535
Epoch 514/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00514: loss did not improve from 0.00535
Epoch 515/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0053

Epoch 00515: loss did not improve from 0.00535
Epoch 516/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0054

Epoch 00516: loss did not improve from 0.00535
Epoch 517/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0054

Epoch 00517: loss did not improve from 0.00535
Epoch 518/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00518: loss did not improve from 0.00535
Epoch 519/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00519: loss did not improve from 0.00535
Epoch 520/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00520: loss did not improve from 0.00535
Epoch 521/1000
16/16 [==============================] - 1s 59ms/step - loss: 0.0054

Epoch 00521: loss did not improve from 0.00535
Epoch 522/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0053

Epoch 00522: loss improved from 0.00535 to 0.00533, saving model to ./model_ae.hdf5
Epoch 523/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0054

Epoch 00523: loss did not improve from 0.00533
Epoch 524/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00524: loss did not improve from 0.00533
Epoch 525/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00525: loss did not improve from 0.00533
Epoch 526/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00526: loss did not improve from 0.00533
Epoch 527/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0053

Epoch 00527: loss did not improve from 0.00533
Epoch 528/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0053

Epoch 00528: loss did not improve from 0.00533
Epoch 529/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00529: loss did not improve from 0.00533
Epoch 530/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00530: loss did not improve from 0.00533
Epoch 531/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00531: loss did not improve from 0.00533
Epoch 532/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0053

Epoch 00532: loss did not improve from 0.00533
Epoch 533/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0054

Epoch 00533: loss did not improve from 0.00533
Epoch 534/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00534: loss did not improve from 0.00533
Epoch 535/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00535: loss did not improve from 0.00533

Epoch 00535: ReduceLROnPlateau reducing learning rate to 3.125000148429535e-05.
Epoch 536/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00536: loss did not improve from 0.00533
Epoch 537/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00537: loss improved from 0.00533 to 0.00533, saving model to ./model_ae.hdf5
Epoch 538/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00538: loss did not improve from 0.00533
Epoch 539/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00539: loss did not improve from 0.00533
Epoch 540/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00540: loss did not improve from 0.00533
Epoch 541/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00541: loss did not improve from 0.00533
Epoch 542/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00542: loss did not improve from 0.00533
Epoch 543/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00543: loss did not improve from 0.00533
Epoch 544/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00544: loss did not improve from 0.00533
Epoch 545/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00545: loss did not improve from 0.00533
Epoch 546/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00546: loss did not improve from 0.00533
Epoch 547/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00547: loss did not improve from 0.00533
Epoch 548/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00548: loss did not improve from 0.00533
Epoch 549/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0053

Epoch 00549: loss did not improve from 0.00533
Epoch 550/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00550: loss did not improve from 0.00533
Epoch 551/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00551: loss did not improve from 0.00533
Epoch 552/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00552: loss did not improve from 0.00533
Epoch 553/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00553: loss improved from 0.00533 to 0.00532, saving model to ./model_ae.hdf5
Epoch 554/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00554: loss did not improve from 0.00532
Epoch 555/1000
16/16 [==============================] - 1s 50ms/step - loss: 0.0054

Epoch 00555: loss did not improve from 0.00532
Epoch 556/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0054

Epoch 00556: loss did not improve from 0.00532
Epoch 557/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00557: loss did not improve from 0.00532
Epoch 558/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00558: loss did not improve from 0.00532
Epoch 559/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00559: loss did not improve from 0.00532
Epoch 560/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0053

Epoch 00560: loss did not improve from 0.00532

Epoch 00560: ReduceLROnPlateau reducing learning rate to 1.5625000742147677e-05.
Epoch 561/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00561: loss did not improve from 0.00532
Epoch 562/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00562: loss did not improve from 0.00532
Epoch 563/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0053

Epoch 00563: loss did not improve from 0.00532
Epoch 564/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00564: loss did not improve from 0.00532
Epoch 565/1000
16/16 [==============================] - 1s 59ms/step - loss: 0.0054

Epoch 00565: loss did not improve from 0.00532
Epoch 566/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00566: loss did not improve from 0.00532
Epoch 567/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0053

Epoch 00567: loss did not improve from 0.00532
Epoch 568/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00568: loss did not improve from 0.00532
Epoch 569/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00569: loss did not improve from 0.00532
Epoch 570/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00570: loss did not improve from 0.00532
Epoch 571/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0053

Epoch 00571: loss did not improve from 0.00532
Epoch 572/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0053

Epoch 00572: loss did not improve from 0.00532
Epoch 573/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0053

Epoch 00573: loss improved from 0.00532 to 0.00531, saving model to ./model_ae.hdf5
Epoch 574/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00574: loss did not improve from 0.00531
Epoch 575/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00575: loss did not improve from 0.00531
Epoch 576/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00576: loss did not improve from 0.00531
Epoch 577/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00577: loss did not improve from 0.00531
Epoch 578/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0053

Epoch 00578: loss did not improve from 0.00531
Epoch 579/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00579: loss did not improve from 0.00531
Epoch 580/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0053

Epoch 00580: loss did not improve from 0.00531
Epoch 581/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0053

Epoch 00581: loss did not improve from 0.00531
Epoch 582/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0053

Epoch 00582: loss did not improve from 0.00531
Epoch 583/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00583: loss did not improve from 0.00531
Epoch 584/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00584: loss did not improve from 0.00531
Epoch 585/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0053

Epoch 00585: loss did not improve from 0.00531

Epoch 00585: ReduceLROnPlateau reducing learning rate to 1e-05.
Epoch 586/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00586: loss did not improve from 0.00531
Epoch 587/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00587: loss did not improve from 0.00531
Epoch 588/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0053

Epoch 00588: loss did not improve from 0.00531
Epoch 589/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0054

Epoch 00589: loss did not improve from 0.00531
Epoch 590/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0053

Epoch 00590: loss did not improve from 0.00531
Epoch 591/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00591: loss did not improve from 0.00531
Epoch 592/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00592: loss did not improve from 0.00531
Epoch 593/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00593: loss did not improve from 0.00531
Epoch 594/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00594: loss improved from 0.00531 to 0.00531, saving model to ./model_ae.hdf5
Epoch 595/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00595: loss did not improve from 0.00531
Epoch 596/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0053

Epoch 00596: loss did not improve from 0.00531
Epoch 597/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0053

Epoch 00597: loss did not improve from 0.00531
Epoch 598/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00598: loss did not improve from 0.00531
Epoch 599/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00599: loss did not improve from 0.00531
Epoch 600/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00600: loss did not improve from 0.00531
Epoch 601/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0054

Epoch 00601: loss did not improve from 0.00531
Epoch 602/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00602: loss did not improve from 0.00531
Epoch 603/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00603: loss did not improve from 0.00531
Epoch 604/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00604: loss did not improve from 0.00531
Epoch 605/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0053

Epoch 00605: loss did not improve from 0.00531
Epoch 606/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0053

Epoch 00606: loss did not improve from 0.00531
Epoch 607/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00607: loss did not improve from 0.00531
Epoch 608/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00608: loss did not improve from 0.00531
Epoch 609/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0053

Epoch 00609: loss did not improve from 0.00531
Epoch 610/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0053

Epoch 00610: loss did not improve from 0.00531
Epoch 611/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00611: loss did not improve from 0.00531
Epoch 612/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0053

Epoch 00612: loss did not improve from 0.00531
Epoch 613/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0053

Epoch 00613: loss did not improve from 0.00531
Epoch 614/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00614: loss did not improve from 0.00531
Epoch 615/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00615: loss did not improve from 0.00531
Epoch 616/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0053

Epoch 00616: loss did not improve from 0.00531
Epoch 617/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00617: loss did not improve from 0.00531
Epoch 618/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00618: loss did not improve from 0.00531
Epoch 619/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00619: loss did not improve from 0.00531
Epoch 620/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00620: loss did not improve from 0.00531
Epoch 621/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00621: loss did not improve from 0.00531
Epoch 622/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0053

Epoch 00622: loss did not improve from 0.00531
Epoch 623/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0053

Epoch 00623: loss did not improve from 0.00531
Epoch 624/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00624: loss did not improve from 0.00531
Epoch 625/1000
16/16 [==============================] - 1s 52ms/step - loss: 0.0053

Epoch 00625: loss did not improve from 0.00531
Epoch 626/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0054

Epoch 00626: loss did not improve from 0.00531
Epoch 627/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00627: loss did not improve from 0.00531
Epoch 628/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00628: loss did not improve from 0.00531
Epoch 629/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00629: loss did not improve from 0.00531
Epoch 630/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00630: loss did not improve from 0.00531
Epoch 631/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00631: loss did not improve from 0.00531
Epoch 632/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00632: loss did not improve from 0.00531
Epoch 633/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0054

Epoch 00633: loss did not improve from 0.00531
Epoch 634/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00634: loss did not improve from 0.00531
Epoch 635/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0054

Epoch 00635: loss did not improve from 0.00531
Epoch 636/1000
16/16 [==============================] - 1s 58ms/step - loss: 0.0054

Epoch 00636: loss did not improve from 0.00531
Epoch 637/1000
16/16 [==============================] - 1s 57ms/step - loss: 0.0053

Epoch 00637: loss did not improve from 0.00531
Epoch 638/1000
16/16 [==============================] - 1s 53ms/step - loss: 0.0053

Epoch 00638: loss did not improve from 0.00531
Epoch 639/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00639: loss did not improve from 0.00531
Epoch 640/1000
16/16 [==============================] - 1s 56ms/step - loss: 0.0053

Epoch 00640: loss did not improve from 0.00531
Epoch 641/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0054

Epoch 00641: loss did not improve from 0.00531
Epoch 642/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00642: loss did not improve from 0.00531
Epoch 643/1000
16/16 [==============================] - 1s 55ms/step - loss: 0.0053

Epoch 00643: loss did not improve from 0.00531
Epoch 644/1000
16/16 [==============================] - 1s 54ms/step - loss: 0.0053

Epoch 00644: loss did not improve from 0.00531
Epoch 00644: early stopping
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ae_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;model_ae.hdf5&#39;</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;LatentCovarianceLayer&quot;</span><span class="p">:</span> <span class="n">LatentCovarianceLayer</span><span class="p">})</span>
<span class="n">ae_decoder</span> <span class="o">=</span> <span class="n">ae_model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)):</span>
    <span class="n">img_dec</span> <span class="o">=</span> <span class="n">ae_decoder</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">]])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_dec</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;z=(</span><span class="si">{</span><span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">, 0)&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)):</span>
    <span class="n">img_dec</span> <span class="o">=</span> <span class="n">ae_decoder</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">]]])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_dec</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;z=(0, </span><span class="si">{</span><span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/pca_ae_hierarchy_36_0.png" src="../_images/pca_ae_hierarchy_36_0.png" />
<img alt="../_images/pca_ae_hierarchy_36_1.png" src="../_images/pca_ae_hierarchy_36_1.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ml"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Zhiyao Yin<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>